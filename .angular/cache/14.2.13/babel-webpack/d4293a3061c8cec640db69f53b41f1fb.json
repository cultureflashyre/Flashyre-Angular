{"ast":null,"code":"import { __decorate } from \"tslib\";\nimport { Component } from '@angular/core';\nimport { forkJoin } from 'rxjs';\nlet CandidateJobDetailView = class CandidateJobDetailView {\n  constructor(title, meta, route, router, jobService, authService) {\n    this.title = title;\n    this.meta = meta;\n    this.route = route;\n    this.router = router;\n    this.jobService = jobService;\n    this.authService = authService;\n    this.selectedJob = null;\n    this.recommendedJobs = [];\n    this.appliedJobIds = [];\n    this.isLoading = true;\n    this.errorMessage = '';\n    this.processingApplications = {};\n    this.applicationSuccess = {};\n    this.title.setTitle('Candidate-Job-Detail-View - Flashyre');\n    this.meta.addTags([{\n      property: 'og:title',\n      content: 'Candidate-Job-Detail-View - Flashyre'\n    }, {\n      property: 'og:image',\n      content: 'https://aheioqhobo.cloudimg.io/v7/_playground-bucket-v2.teleporthq.io_/8203932d-6f2d-4493-a7b2-7000ee521aa2/9aea8e9c-27ce-4011-a345-94a92ae2dbf8?org_if_sml=1&force_format=original'\n    }]);\n  }\n\n  ngOnInit() {\n    this.route.queryParams.subscribe(params => {\n      const jobId = params['jobId'];\n\n      if (jobId) {\n        this.loadJobDetails(jobId);\n      } else {\n        console.warn('No jobId provided in query parameters, loading recommended jobs');\n        this.loadRecommendedJobs();\n      }\n    });\n  }\n\n  loadJobDetails(jobId) {\n    this.isLoading = true;\n    this.errorMessage = '';\n    forkJoin({\n      job: this.jobService.getJobDetails(jobId),\n      appliedJobs: this.authService.getAppliedJobs(),\n      recommended: this.jobService.getRecommendedJobs([])\n    }).subscribe(({\n      job,\n      appliedJobs,\n      recommended\n    }) => {\n      this.selectedJob = job;\n      this.appliedJobIds = appliedJobs.applied_job_ids || [];\n      this.recommendedJobs = recommended.filter(r => r.job_type === this.selectedJob.job_type && !this.appliedJobIds.includes(r.job_id) && r.job_id !== parseInt(jobId));\n      this.isLoading = false;\n    }, error => {\n      console.error('Error loading job details or recommended jobs:', error);\n      this.errorMessage = 'Failed to load job details. Please try again later.';\n      this.isLoading = false;\n    });\n  }\n\n  loadRecommendedJobs() {\n    this.isLoading = true;\n    this.errorMessage = '';\n    forkJoin({\n      appliedJobs: this.authService.getAppliedJobs(),\n      recommended: this.jobService.getRecommendedJobs([])\n    }).subscribe(({\n      appliedJobs,\n      recommended\n    }) => {\n      this.appliedJobIds = appliedJobs.applied_job_ids || [];\n      this.recommendedJobs = recommended.filter(r => !this.appliedJobIds.includes(r.job_id));\n      this.isLoading = false;\n\n      if (this.recommendedJobs.length > 0) {\n        this.selectedJob = this.recommendedJobs[0]; // Select the first recommended job as default\n      } else {\n        this.errorMessage = 'No jobs available at the moment.';\n      }\n    }, error => {\n      console.error('Error loading recommended jobs:', error);\n      this.errorMessage = 'Failed to load jobs. Please try again later.';\n      this.isLoading = false;\n    });\n  }\n\n  applyForJob(jobId, index) {\n    this.processingApplications[jobId] = true;\n    this.authService.applyForJob(jobId).subscribe(response => {\n      console.log('Application successful:', response);\n      this.applicationSuccess[jobId] = true;\n      this.appliedJobIds.push(jobId);\n      setTimeout(() => {\n        this.recommendedJobs = this.recommendedJobs.filter(job => job.job_id !== jobId);\n      }, 2000);\n    }, error => {\n      var _a;\n\n      console.error('Application failed:', error);\n      this.processingApplications[jobId] = false;\n      alert(((_a = error.error) === null || _a === void 0 ? void 0 : _a.error) || 'Failed to apply for this job');\n    });\n  }\n\n  navigateToAssessment(jobId) {\n    this.router.navigate(['/flashyre-rules', jobId]);\n  }\n\n  navigateToHome() {\n    this.router.navigate(['/candidate-home']);\n  }\n\n};\nCandidateJobDetailView = __decorate([Component({\n  selector: 'candidate-job-detail-view',\n  templateUrl: 'candidate-job-detail-view.component.html',\n  styleUrls: ['candidate-job-detail-view.component.css']\n})], CandidateJobDetailView);\nexport { CandidateJobDetailView };","map":null,"metadata":{},"sourceType":"module"}
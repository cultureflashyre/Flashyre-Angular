{"ast":null,"code":"import { __awaiter, __decorate } from \"tslib\";\nimport { Component } from '@angular/core';\nlet FlashyreAssessments = class FlashyreAssessments {\n  constructor(title, meta, assessmentService, videoRecorder, proctoringService) {\n    this.title = title;\n    this.meta = meta;\n    this.assessmentService = assessmentService;\n    this.videoRecorder = videoRecorder;\n    this.proctoringService = proctoringService;\n    this.assessmentData = {};\n    this.sections = [];\n    this.currentQuestions = [];\n    this.currentQuestionIndex = 0;\n    this.title.setTitle('Flashyre-Assessments - Flashyre');\n    this.meta.addTags([{\n      property: 'og:title',\n      content: 'Flashyre-Assessments - Flashyre'\n    }, {\n      property: 'og:image',\n      content: 'https://aheioqhobo.cloudimg.io/v7/_playground-bucket-v2.teleporthq.io_/8203932d-6f2d-4493-a7b2-7000ee521aa2/9aea8e9c-27ce-4011-a345-94a92ae2dbf8?org_if_sml=1&force_format=original'\n    }]);\n  }\n\n  ngOnInit() {\n    return __awaiter(this, void 0, void 0, function* () {\n      const assessmentId = 1; // Replace with actual assessment ID\n\n      this.fetchAssessmentData(assessmentId);\n\n      try {\n        yield this.videoRecorder.startRecording();\n        this.proctoringService.startMonitoring();\n      } catch (error) {\n        console.error('Failed to start assessment:', error);\n      }\n    });\n  }\n\n  ngOnDestroy() {\n    if (this.timerSubscription) {\n      this.timerSubscription.unsubscribe();\n    }\n\n    clearInterval(this.timerInterval); // <-- Clear interval on destroy\n  }\n\n  fetchAssessmentData(assessmentId) {\n    this.assessmentService.getAssessmentData(assessmentId).subscribe(data => {\n      this.assessmentData = data;\n      this.sections = Object.keys(data.sections).map(sectionName => Object.assign({\n        name: sectionName\n      }, data.sections[sectionName]));\n      this.timer = data.total_assessment_duration * 60; // Convert minutes to seconds\n\n      this.assessmentService.updateTimer(this.timer);\n      console.log(\"timer data in seconds: \", this.timer);\n      this.startTimer();\n      this.selectSection(this.sections[0]);\n    });\n  }\n\n  startTimer() {\n    this.timerSubscription = this.assessmentService.timer$.subscribe(time => {\n      this.timer = time;\n      console.log(\"timer data in startTimer(): \", this.timer);\n\n      if (this.timer <= 0) {\n        this.terminateTest();\n      }\n    });\n    this.decrementTimer();\n  }\n\n  decrementTimer() {\n    this.timerInterval = setInterval(() => {\n      if (this.timer > 0) {\n        this.assessmentService.updateTimer(this.timer - 1);\n      } else {\n        clearInterval(this.timerInterval); // <-- Clean up when done\n      }\n    }, 1000);\n  }\n\n  selectSection(section) {\n    this.currentSection = section;\n    this.currentQuestions = section.questions;\n    this.currentQuestionIndex = 0;\n  }\n\n  navigateToQuestion(index) {\n    if (index >= 0 && index < this.currentQuestions.length) {\n      this.currentQuestionIndex = index;\n    }\n  }\n\n  terminateTest() {\n    console.log('Test terminated');\n  }\n\n  submitTest() {\n    console.log('Test submitted');\n  }\n\n};\nFlashyreAssessments = __decorate([Component({\n  selector: 'flashyre-assessments',\n  templateUrl: 'flashyre-assessments.component.html',\n  styleUrls: ['flashyre-assessments.component.css']\n})], FlashyreAssessments);\nexport { FlashyreAssessments };","map":null,"metadata":{},"sourceType":"module"}
{"ast":null,"code":"import { __awaiter, __decorate } from \"tslib\";\nlet VideoRecorderService = class VideoRecorderService {\n  constructor() {\n    this.recordedChunks = [];\n  }\n\n  startRecording() {\n    var _a;\n\n    return __awaiter(this, void 0, void 0, function* () {\n      try {\n        this.stream = yield navigator.mediaDevices.getUserMedia({\n          video: true,\n          audio: true\n        });\n        this.mediaRecorder = new MediaRecorder(this.stream, {\n          mimeType: 'video/webm'\n        });\n\n        this.mediaRecorder.ondataavailable = event => {\n          if (event.data.size > 0) {\n            this.recordedChunks.push(event.data);\n            this.saveVideoChunk(event.data);\n          }\n        };\n\n        this.mediaRecorder.start(300000); // 5 minute chunks\n        // Add video preview\n\n        const videoElement = document.createElement('video');\n        videoElement.srcObject = this.stream;\n        videoElement.autoplay = true;\n        (_a = document.getElementById('video-container')) === null || _a === void 0 ? void 0 : _a.appendChild(videoElement);\n      } catch (error) {\n        console.error('Error accessing media devices:', error);\n        throw error;\n      }\n    });\n  }\n\n  saveVideoChunk(chunk) {\n    const formData = new FormData();\n    formData.append('video_chunk', chunk);\n    formData.append('timestamp', new Date().toISOString());\n    this.http.post(`${this.apiUrl}/save-video`, formData).subscribe();\n  }\n\n  stopRecording() {\n    var _a;\n\n    if (((_a = this.mediaRecorder) === null || _a === void 0 ? void 0 : _a.state) === 'recording') {\n      this.mediaRecorder.stop();\n      this.stream.getTracks().forEach(track => track.stop());\n    }\n  }\n\n};\nVideoRecorderService = __decorate([Injectable({\n  providedIn: 'root'\n})], VideoRecorderService);\nexport { VideoRecorderService };","map":null,"metadata":{},"sourceType":"module"}
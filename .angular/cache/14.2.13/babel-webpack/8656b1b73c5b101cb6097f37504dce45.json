{"ast":null,"code":"import { __decorate } from \"tslib\";\nimport { Component } from '@angular/core';\nimport { Validators } from '@angular/forms';\nlet CreateJobPost1stPageComponent = class CreateJobPost1stPageComponent {\n  constructor(route, corporateAuthService, jobDescriptionService, fb) {\n    this.route = route;\n    this.corporateAuthService = corporateAuthService;\n    this.jobDescriptionService = jobDescriptionService;\n    this.fb = fb;\n    this.jobData = null;\n    this.jobForm = this.fb.group({\n      role: ['', [Validators.required, Validators.maxLength(100)]],\n      location: ['', [Validators.required, Validators.maxLength(200)]],\n      job_type: ['', [Validators.required]],\n      workplace_type: ['', [Validators.required]],\n      total_experience_min: [0, [Validators.required, Validators.min(0)]],\n      total_experience_max: [0, [Validators.required, Validators.min(0)]],\n      relevant_experience_min: [0, [Validators.required, Validators.min(0)]],\n      relevant_experience_max: [0, [Validators.required, Validators.min(0)]],\n      budget_type: ['', [Validators.required]],\n      min_budget: [0, [Validators.required, Validators.min(0)]],\n      max_budget: [0, [Validators.required, Validators.min(0)]],\n      notice_period: ['', [Validators.required, Validators.maxLength(50)]],\n      skills: [[]],\n      job_description: ['', Validators.maxLength(5000)],\n      unique_id: ['']\n    }, {\n      validators: this.experienceRangeValidator\n    });\n  }\n\n  ngOnInit() {\n    const uniqueId = this.route.snapshot.paramMap.get('unique_id');\n\n    if (uniqueId) {\n      const token = this.corporateAuthService.getJWTToken();\n\n      if (token) {\n        this.jobDescriptionService.getJobPost(uniqueId, token).subscribe({\n          next: jobPost => {\n            this.jobData = jobPost;\n            this.populateFormControls(jobPost);\n            setTimeout(() => {\n              this.populateCustomUI();\n            }, 0);\n          },\n          error: error => {\n            console.error('Failed to load job post:', error);\n          }\n        });\n      }\n    }\n  }\n\n  experienceRangeValidator(form) {\n    var _a, _b, _c, _d;\n\n    const totalMin = (_a = form.get('total_experience_min')) === null || _a === void 0 ? void 0 : _a.value;\n    const totalMax = (_b = form.get('total_experience_max')) === null || _b === void 0 ? void 0 : _b.value;\n    const relevantMin = (_c = form.get('relevant_experience_min')) === null || _c === void 0 ? void 0 : _c.value;\n    const relevantMax = (_d = form.get('relevant_experience_max')) === null || _d === void 0 ? void 0 : _d.value;\n\n    if (totalMin > totalMax) {\n      return {\n        invalidTotalExperience: true\n      };\n    }\n\n    if (relevantMin > relevantMax) {\n      return {\n        invalidRelevantExperience: true\n      };\n    }\n\n    return null;\n  }\n\n  populateFormControls(jobData) {\n    var _a, _b, _c;\n\n    let role;\n    let location;\n    let job_type;\n    let workplace_type;\n    let total_experience_min;\n    let total_experience_max;\n    let relevant_experience_min;\n    let relevant_experience_max;\n    let budget_type;\n    let min_budget;\n    let max_budget;\n    let notice_period;\n    let skills;\n    let job_description;\n\n    if ('job_details' in jobData) {\n      const aiJobData = jobData;\n      const jobDetails = aiJobData.job_details;\n      const [minExp, maxExp] = this.parseExperience(((_a = jobDetails.experience) === null || _a === void 0 ? void 0 : _a.value) || '0-0 years');\n      role = ((_b = jobDetails.job_titles[0]) === null || _b === void 0 ? void 0 : _b.value) || 'Unknown';\n      location = jobDetails.location || 'Unknown';\n      job_type = this.mapJobType(((_c = jobDetails.job_titles[0]) === null || _c === void 0 ? void 0 : _c.value) || '');\n      workplace_type = jobDetails.workplace_type || 'Remote';\n      total_experience_min = minExp;\n      total_experience_max = maxExp;\n      relevant_experience_min = Math.max(0, minExp - 1);\n      relevant_experience_max = Math.min(maxExp, minExp + 2);\n      budget_type = jobDetails.budget_type || 'Annually';\n      min_budget = jobDetails.min_budget || 0;\n      max_budget = jobDetails.max_budget || 0;\n      notice_period = jobDetails.notice_period || '30 days';\n      skills = [...(jobDetails.skills.primary || []).map(s => s.skill), ...(jobDetails.skills.secondary || []).map(s => s.skill)];\n      job_description = jobDetails.job_description || '';\n    } else {\n      const jobDetails = jobData;\n      role = jobDetails.role;\n      location = jobDetails.location;\n      job_type = jobDetails.job_type;\n      workplace_type = jobDetails.workplace_type;\n      total_experience_min = jobDetails.total_experience_min;\n      total_experience_max = jobDetails.total_experience_max;\n      relevant_experience_min = jobDetails.relevant_experience_min;\n      relevant_experience_max = jobDetails.relevant_experience_max;\n      budget_type = jobDetails.budget_type;\n      min_budget = jobDetails.min_budget;\n      max_budget = jobDetails.max_budget;\n      notice_period = jobDetails.notice_period;\n      skills = jobDetails.skills.primary.map(s => s.skill).concat(jobDetails.skills.secondary.map(s => s.skill));\n      job_description = jobDetails.job_description;\n    }\n\n    this.jobForm.patchValue({\n      role,\n      location,\n      job_type,\n      workplace_type,\n      total_experience_min,\n      total_experience_max,\n      relevant_experience_min,\n      relevant_experience_max,\n      budget_type,\n      min_budget,\n      max_budget,\n      notice_period,\n      skills,\n      job_description,\n      unique_id: 'unique_id' in jobData ? jobData.unique_id : jobData.unique_id\n    });\n  }\n\n  populateCustomUI() {\n    const totalRangeIndicator = document.getElementById('total_rangeIndicator');\n\n    if (totalRangeIndicator) {\n      this.setExperienceRange('total', this.jobForm.get('total_experience_min').value, this.jobForm.get('total_experience_max').value);\n    } else {\n      console.warn('Total experience range indicator not found');\n    }\n\n    const relevantRangeIndicator = document.getElementById('relevant_rangeIndicator');\n\n    if (relevantRangeIndicator) {\n      this.setExperienceRange('relevant', this.jobForm.get('relevant_experience_min').value, this.jobForm.get('relevant_experience_max').value);\n    } else {\n      console.warn('Relevant experience range indicator not found');\n    }\n\n    const tagContainer = document.getElementById('tagContainer');\n    const tagInput = document.getElementById('tagInput');\n    const skills = this.jobForm.get('skills').value;\n\n    if (tagContainer && tagInput && skills) {\n      skills.forEach(skill => {\n        const tag = document.createElement('div');\n        tag.className = 'tag';\n        const tagText = document.createElement('span');\n        tagText.textContent = skill;\n        tag.appendChild(tagText);\n        const removeBtn = document.createElement('button');\n        removeBtn.textContent = 'Ã—';\n        removeBtn.addEventListener('click', () => {\n          tag.remove();\n          const currentSkills = this.jobForm.get('skills').value || [];\n          const updatedSkills = currentSkills.filter(s => s !== skill);\n          this.jobForm.patchValue({\n            skills: updatedSkills\n          });\n        });\n        tag.appendChild(removeBtn);\n        tagContainer.insertBefore(tag, tagInput);\n      });\n    } else {\n      console.warn('Tag container or skills not found');\n    }\n\n    const editor = document.getElementById('editor');\n\n    if (editor && this.jobForm.get('job_description').value) {\n      editor.innerHTML = this.jobForm.get('job_description').value;\n    } else {\n      console.warn('Editor element or job description not found');\n    }\n  }\n\n  setExperienceRange(type, min, max) {\n    const prefix = type === 'total' ? 'total_' : 'relevant_';\n    const rangeIndicator = document.getElementById(`${prefix}rangeIndicator`);\n    const markerLeft = document.getElementById(`${prefix}markerLeft`);\n    const markerRight = document.getElementById(`${prefix}markerRight`);\n    const labelLeft = document.getElementById(`${prefix}labelLeft`);\n    const labelRight = document.getElementById(`${prefix}labelRight`);\n    const filledSegment = document.getElementById(`${prefix}filledSegment`);\n\n    if (rangeIndicator && markerLeft && markerRight && labelLeft && labelRight && filledSegment) {\n      const rect = rangeIndicator.getBoundingClientRect();\n      const width = rect.width;\n      const maxYears = 20; // Adjust based on your range (e.g., 0-20 years)\n\n      const minPos = min / maxYears * (width - 10);\n      const maxPos = max / maxYears * (width - 10);\n      markerLeft.style.left = `${minPos}px`;\n      markerRight.style.left = `${maxPos}px`;\n      labelLeft.style.left = `${minPos + 5}px`;\n      labelLeft.textContent = `${min} yrs`;\n      labelRight.style.left = `${maxPos + 5}px`;\n      labelRight.textContent = `${max} yrs`;\n      filledSegment.style.left = `${minPos + 5}px`;\n      filledSegment.style.width = `${maxPos - minPos}px`;\n    }\n  }\n\n  parseExperience(experience) {\n    const [min, max] = experience.split('-').map(Number);\n    return [min || 0, max || 0];\n  }\n\n  mapJobType(jobTitle) {\n    // Implement based on your logic\n    return 'Full-time'; // Example\n  }\n\n};\nCreateJobPost1stPageComponent = __decorate([Component({\n  selector: 'app-create-job-post1st-page',\n  templateUrl: './create-job-post1st-page.component.html',\n  styleUrls: ['./create-job-post1st-page.component.css']\n})], CreateJobPost1stPageComponent);\nexport { CreateJobPost1stPageComponent };","map":null,"metadata":{},"sourceType":"module"}
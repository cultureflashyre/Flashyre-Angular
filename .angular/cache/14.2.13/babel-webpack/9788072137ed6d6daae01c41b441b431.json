{"ast":null,"code":"import { __decorate } from \"tslib\";\nimport { Component, Input } from '@angular/core';\nlet CandidateJobDetailsComponent = class CandidateJobDetailsComponent {\n  constructor(route, router, jobsService) {\n    this.route = route;\n    this.router = router;\n    this.jobsService = jobsService;\n    this.rootClassName = 'candidate-default-root';\n    this.jobId = null;\n    this.jobs = [];\n    this.selectedJobId = null;\n    this.job = null;\n    this.errorMessage = null;\n    this.loading = false;\n  }\n\n  ngOnInit() {\n    console.log('CandidateJobDetailsComponent initialized'); // Fetch job list\n\n    this.jobsService.getJobs().subscribe({\n      next: data => {\n        this.jobs = data; // Subscribe to query params for jobId\n\n        this.route.queryParamMap.subscribe(params => {\n          const jobId = params.get('jobId');\n\n          if (jobId) {\n            this.selectedJobId = +jobId;\n            this.jobId = +jobId;\n            this.fetchJobDetails(this.selectedJobId);\n          } else {\n            this.errorMessage = 'No job selected';\n          }\n        });\n      },\n      error: err => {\n        this.errorMessage = err.message || 'Failed to load jobs';\n        console.error('Error fetching jobs:', err);\n      }\n    });\n  }\n\n  ngOnChanges(changes) {\n    if (changes['jobId'] && changes['jobId'].currentValue !== null) {\n      console.log('jobId changed to:', changes['jobId'].currentValue);\n      this.selectedJobId = changes['jobId'].currentValue;\n      this.fetchJobDetails(this.selectedJobId);\n    } else if (changes['jobId'] && changes['jobId'].currentValue === null) {\n      console.log('jobId reset to null');\n      this.errorMessage = 'No job selected';\n      this.job = null;\n    }\n  }\n\n  onJobSelected(jobId) {\n    console.log('Job selected:', jobId);\n    this.router.navigate([], {\n      queryParams: {\n        jobId\n      },\n      queryParamsHandling: 'merge'\n    });\n    this.selectedJobId = jobId;\n    this.jobId = jobId;\n    this.fetchJobDetails(jobId);\n  }\n\n  applyForJob() {\n    var _a, _b;\n\n    if ((_a = this.job) === null || _a === void 0 ? void 0 : _a.url) {\n      console.log('Applying for job, opening URL:', this.job.url);\n      window.open(this.job.url, '_blank');\n    } else {\n      console.warn('No application URL provided for job:', (_b = this.job) === null || _b === void 0 ? void 0 : _b.job_id);\n      this.errorMessage = 'No application URL available';\n    }\n  }\n\n  fetchJobDetails(jobId) {\n    this.loading = true;\n    this.errorMessage = null;\n    this.jobsService.getJobById(jobId).subscribe({\n      next: data => {\n        this.job = {\n          job_id: data.job_id || null,\n          company_name: data.company_name || '',\n          logo: data.logo || '',\n          title: data.title || '',\n          location: data.location || '',\n          job_type: data.job_type || '',\n          created_at: data.created_at || '',\n          description: data.description || '',\n          requirements: data.requirements || '',\n          salary: data.salary || '',\n          url: data.url || ''\n        };\n        console.log('Job details set:', this.job);\n        this.loading = false;\n      },\n      error: err => {\n        this.errorMessage = err.message || `Failed to load job details for jobId: ${jobId}`;\n        console.error('Error fetching job details:', err);\n        this.job = null;\n        this.loading = false;\n      }\n    });\n  }\n\n};\n\n__decorate([Input()], CandidateJobDetailsComponent.prototype, \"rootClassName\", void 0);\n\n__decorate([Input()], CandidateJobDetailsComponent.prototype, \"jobId\", void 0);\n\nCandidateJobDetailsComponent = __decorate([Component({\n  selector: 'app-candidate-job-details',\n  templateUrl: './candidate-job-details.component.html',\n  styleUrls: ['./candidate-job-details.component.css']\n})], CandidateJobDetailsComponent);\nexport { CandidateJobDetailsComponent };","map":null,"metadata":{},"sourceType":"module"}
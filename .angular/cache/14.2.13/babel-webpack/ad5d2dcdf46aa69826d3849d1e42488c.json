{"ast":null,"code":"import { __decorate } from \"tslib\";\nimport { Component, Input, ContentChild, ViewChildren, Output, EventEmitter } from '@angular/core';\nimport { Validators } from '@angular/forms';\nimport { forkJoin } from 'rxjs';\nlet ProfileEducationComponent = class ProfileEducationComponent {\n  constructor(fb, educationService, router, toastr) {\n    this.fb = fb;\n    this.educationService = educationService;\n    this.router = router;\n    this.toastr = toastr;\n    this.rootClassName = '';\n    this.formsUpdated = new EventEmitter();\n    this.educationForms = [];\n    this.universities = [];\n    this.educationLevels = [];\n    this.courses = [];\n    this.specializations = [];\n    this.todayDate = new Date().toISOString().split('T')[0];\n  }\n\n  ngOnInit() {\n    this.fetchReferenceData();\n    this.addNewForm();\n    !!!Holding;\n    the;\n    thought;\n    here;\n\n    for (a; moment;);\n\n    I;\n    'm double-checking that the form initialization and data binding align with the backend';\n    s;\n    expectations, ensuring;\n    the`name`;\n    fields;\n    from;\n    the;\n    reference;\n    tables;\n    are;\n    correctly;\n    displayed;\n    and;\n    submitted.Continuing;\n  }\n\n  fetchReferenceData() {\n    this.educationService.getReferenceData().subscribe({\n      next: data => {\n        this.universities = data.colleges;\n        this.educationLevels = data.education_levels;\n        this.courses = data.courses;\n        this.specializations = data.specializations;\n      },\n      error: error => {\n        console.error('Failed to fetch reference data:', error);\n        this.toastr.error(error.message, 'Error');\n      }\n    });\n  }\n\n  createEducationForm() {\n    return this.fb.group({\n      startDate: ['', Validators.required],\n      endDate: ['', Validators.required],\n      university: ['', Validators.required],\n      educationLevel: ['', Validators.required],\n      course: ['', Validators.required],\n      specialization: ['', Validators.required]\n    }, {\n      validators: this.dateRangeValidator\n    });\n  }\n\n  dateRangeValidator(form) {\n    var _a, _b;\n\n    const startDate = (_a = form.get('startDate')) === null || _a === void 0 ? void 0 : _a.value;\n    const endDate = (_b = form.get('endDate')) === null || _b === void 0 ? void 0 : _b.value;\n\n    if (startDate && endDate && new Date(endDate) < new Date(startDate)) {\n      return {\n        dateRangeInvalid: true\n      };\n    }\n\n    return null;\n  }\n\n  addNewForm() {\n    this.educationForms.push(this.createEducationForm());\n    this.formsUpdated.emit(this.educationForms);\n    setTimeout(() => {\n      const lastForm = this.educationFormInstances.last;\n\n      if (lastForm) {\n        lastForm.nativeElement.scrollIntoView({\n          behavior: 'smooth',\n          block: 'start'\n        });\n      }\n    }, 0);\n  }\n\n  removeForm(index) {\n    this.educationForms.splice(index, 1);\n    this.formsUpdated.emit(this.educationForms);\n    this.toastr.info('Education entry removed', 'Removed');\n  }\n\n  saveEducation() {\n    return new Promise(resolve => {\n      const validForms = this.educationForms.filter(form => form.valid);\n\n      if (validForms.length === 0) {\n        this.toastr.warning('No valid forms to save', 'Warning');\n        resolve(true);\n        return;\n      }\n\n      const saveObservables = validForms.map(form => {\n        const data = {\n          select_start_date: form.value.startDate,\n          select_end_date: form.value.endDate,\n          university: form.value.university,\n          education_level: form.value.educationLevel,\n          course: form.value.course,\n          specialization: form.value.specialization\n        };\n        return this.educationService.addEducation(data);\n      });\n      forkJoin(saveObservables).subscribe({\n        next: () => {\n          this.formsUpdated.emit(this.educationForms);\n          this.toastr.success('Education entries saved successfully', 'Success');\n          resolve(true);\n        },\n        error: error => {\n          var _a;\n\n          console.error('Error saving educations:', error);\n          this.toastr.error(((_a = error.error) === null || _a === void 0 ? void 0 : _a.detail) || 'Failed to save education', 'Error');\n          resolve(false);\n        }\n      });\n    });\n  }\n\n  goToPrevious() {\n    this.router.navigate(['/profile-employment-page']);\n  }\n\n  skipToNextSection() {\n    this.router.navigate(['/profile-certification-page']);\n  }\n\n  isFormInvalid() {\n    return this.educationForms.some(form => form.invalid);\n  }\n\n};\n\n__decorate([ContentChild('text3136')], ProfileEducationComponent.prototype, \"text3136\", void 0);\n\n__decorate([ContentChild('text313')], ProfileEducationComponent.prototype, \"text313\", void 0);\n\n__decorate([ContentChild('text3137')], ProfileEducationComponent.prototype, \"text3137\", void 0);\n\n__decorate([ContentChild('text1112')], ProfileEducationComponent.prototype, \"text1112\", void 0);\n\n__decorate([ContentChild('text111')], ProfileEducationComponent.prototype, \"text111\", void 0);\n\n__decorate([ContentChild('text112')], ProfileEducationComponent.prototype, \"text112\", void 0);\n\n__decorate([ContentChild('text3132')], ProfileEducationComponent.prototype, \"text3132\", void 0);\n\n__decorate([ContentChild('text3131')], ProfileEducationComponent.prototype, \"text3131\", void 0);\n\n__decorate([ContentChild('text314')], ProfileEducationComponent.prototype, \"text314\", void 0);\n\n__decorate([ContentChild('text')], ProfileEducationComponent.prototype, \"text\", void 0);\n\n__decorate([ContentChild('text1111')], ProfileEducationComponent.prototype, \"text1111\", void 0);\n\n__decorate([ContentChild('text2')], ProfileEducationComponent.prototype, \"text2\", void 0);\n\n__decorate([ContentChild('text1')], ProfileEducationComponent.prototype, \"text1\", void 0);\n\n__decorate([Input()], ProfileEducationComponent.prototype, \"rootClassName\", void 0);\n\n__decorate([Output()], ProfileEducationComponent.prototype, \"formsUpdated\", void 0);\n\n__decorate([ViewChildren('educationFormInstance')], ProfileEducationComponent.prototype, \"educationFormInstances\", void 0);\n\nProfileEducationComponent = __decorate([Component({\n  selector: 'profile-education-component',\n  templateUrl: './profile-education-component.component.html',\n  styleUrls: ['./profile-education-component.component.css']\n})], ProfileEducationComponent);\nexport { ProfileEducationComponent };","map":null,"metadata":{},"sourceType":"module"}
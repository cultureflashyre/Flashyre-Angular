{"ast":null,"code":"import { __decorate, __param } from \"tslib\";\nimport { Component, ViewChild, Inject } from '@angular/core';\nimport { DOCUMENT } from '@angular/common';\nimport { Validators } from '@angular/forms';\nimport { of, fromEvent, throwError } from 'rxjs';\nimport { debounceTime, distinctUntilChanged, switchMap, catchError, map, tap, filter } from 'rxjs/operators';\nimport { HttpHeaders, HttpParams } from '@angular/common/http';\nlet CreateJobPost1stPageComponent = class CreateJobPost1stPageComponent {\n  // --- END: Lightcast API Integration ---\n  constructor(title, meta, fb, snackBar, jobDescriptionService, corporateAuthService, router, route, ngZone, renderer, document, http) {\n    this.title = title;\n    this.meta = meta;\n    this.fb = fb;\n    this.snackBar = snackBar;\n    this.jobDescriptionService = jobDescriptionService;\n    this.corporateAuthService = corporateAuthService;\n    this.router = router;\n    this.route = route;\n    this.ngZone = ngZone;\n    this.renderer = renderer;\n    this.document = document;\n    this.http = http;\n    this.googleMapsApiKey = 'AIzaSyCYvHT8TXJdvdfr0CBRV62q5MzaD008hAE'; // Consider environment variables\n\n    this.googleScriptLoaded = false;\n    this.suggestions = []; // For location\n\n    this.isLoading = false; // For location\n\n    this.isLoadingSkills = false; // For skills API\n\n    this.showSuggestions = false; // For location\n\n    this.selectedFile = null;\n    this.DEBOUNCE_DELAY = 300;\n    this.currentStep = 'jobPost';\n    this.isSubmitting = false;\n    this.isFileUploadCompletedSuccessfully = false;\n    this.displayedFileName = null;\n    this.jobData = null;\n    this.isViewInitialized = false; // --- START: Lightcast API Integration ---\n    // WARNING: Storing secrets in frontend code is insecure for production.\n\n    this.lightcastClientId = 'YOUR_LIGHTCAST_CLIENT_ID'; // <-- REPLACE\n\n    this.lightcastClientSecret = 'YOUR_LIGHTCAST_CLIENT_SECRET'; // <-- REPLACE\n\n    this.lightcastTokenUrl = 'https://auth.emsicloud.com/connect/token';\n    this.lightcastSkillsApiUrl = 'https://skills.lightcast.io/skills/versions/latest/autocomplete';\n    this.lightcastAccessToken = null;\n    this.lightcastTokenExpiryTime = null;\n    this.jobForm = this.fb.group({\n      role: ['', [Validators.required, Validators.maxLength(100)]],\n      location: ['', [Validators.required, Validators.maxLength(200)]],\n      job_type: ['', [Validators.required]],\n      workplace_type: ['', [Validators.required]],\n      total_experience_min: [0, [Validators.required, Validators.min(0), Validators.max(30)]],\n      total_experience_max: [30, [Validators.required, Validators.min(0), Validators.max(30)]],\n      relevant_experience_min: [0, [Validators.required, Validators.min(0), Validators.max(30)]],\n      relevant_experience_max: [30, [Validators.required, Validators.min(0), Validators.max(30)]],\n      budget_type: ['', [Validators.required]],\n      min_budget: [null, [Validators.required, Validators.min(0)]],\n      max_budget: [null, [Validators.required, Validators.min(0)]],\n      notice_period: ['', [Validators.required, Validators.maxLength(50)]],\n      skills: [[], [Validators.required]],\n      job_description: ['', [Validators.required, Validators.maxLength(5000)]],\n      job_description_url: ['', [Validators.maxLength(200)]],\n      unique_id: ['']\n    }, {\n      validators: this.experienceRangeValidator\n    });\n  }\n\n  ngOnInit() {\n    this.title.setTitle('Create Job Post - Flashyre');\n    this.meta.addTags([{\n      property: 'og:title',\n      content: 'Create Job Post - Flashyre'\n    }, {\n      property: 'og:image',\n      content: 'https://aheioqhobo.cloudimg.io/v7/_playground-bucket-v2.teleporthq.io_/8203932d-6f2d-4493-a7b2-7000ee521aa2/9aea8e9c-27ce-4011-a345-94a92ae2dbf8?org_if_sml=1&force_format=original'\n    }]);\n    this.loadGoogleMapsScript().then(() => {\n      const uniqueId = this.route.snapshot.paramMap.get('unique_id');\n\n      if (uniqueId) {\n        // Logic to load existing job post data\n        console.log('Editing existing job post with unique_id:', uniqueId);\n      }\n    }).catch(error => {\n      console.error('Google Maps script could not be loaded.', error);\n      this.snackBar.open('Could not load location services. Please try again later.', 'Close', {\n        duration: 5000\n      });\n    });\n\n    if (!this.corporateAuthService.isLoggedIn()) {\n      this.snackBar.open('Please log in to create a job post.', 'Close', {\n        duration: 5000\n      });\n      this.router.navigate(['/login-corporate']);\n      return;\n    }\n\n    if (this.lightcastClientId === 'YOUR_LIGHTCAST_CLIENT_ID' || this.lightcastClientSecret === 'YOUR_LIGHTCAST_CLIENT_SECRET') {\n      console.warn(\"Lightcast API Client ID/Secret not set. Skills autocompletion will not work.\"); // this.snackBar.open(\"Skills autocompletion is not configured.\", \"Close\", { duration: 7000 }); // Optional: user notification\n    }\n  }\n\n  ngAfterViewInit() {\n    this.isViewInitialized = true;\n\n    if (this.jobData) {\n      this.populateForm(this.jobData);\n    }\n\n    if (this.tagInputRef && this.tagInputRef.nativeElement) {\n      this.initializeSkillsInput();\n    } else {\n      // Attempt to initialize later if element becomes available, or log warning\n      // This might happen if skills section is under an *ngIf that's initially false\n      setTimeout(() => {\n        if (this.tagInputRef && this.tagInputRef.nativeElement) {\n          this.initializeSkillsInput();\n        } else {\n          console.warn('tagInputRef still not available after timeout. Skills autocompletion might not work.');\n        }\n      }, 0);\n    }\n\n    this.initializeRange('total');\n    this.initializeRange('relevant');\n    this.updateExperienceUI(); // Call after ranges are initialized\n\n    this.checkEmpty('editor'); // Check editor after potential population\n\n    if (this.googleScriptLoaded) {\n      this.initializeGooglePlacesAutocomplete();\n      this.setupLocationInputListener();\n    } else {\n      this.loadGoogleMapsScript().then(() => {\n        this.initializeGooglePlacesAutocomplete();\n        this.setupLocationInputListener();\n      }).catch(err => console.error(\"Late script load failed in ngAfterViewInit\", err));\n    }\n  }\n\n  getLightcastAccessToken() {\n    if (this.lightcastAccessToken && this.lightcastTokenExpiryTime && Date.now() < this.lightcastTokenExpiryTime) {\n      return of(this.lightcastAccessToken);\n    }\n\n    const body = new HttpParams().set('client_id', this.lightcastClientId).set('client_secret', this.lightcastClientSecret).set('grant_type', 'client_credentials').set('scope', 'skills-api'); // Confirm scope with Lightcast docs\n\n    const headers = new HttpHeaders({\n      'Content-Type': 'application/x-www-form-urlencoded'\n    });\n    return this.http.post(this.lightcastTokenUrl, body.toString(), {\n      headers\n    }).pipe(map(response => {\n      if (!response.access_token || !response.expires_in) {\n        throw new Error('Invalid token response from Lightcast');\n      }\n\n      this.lightcastAccessToken = response.access_token;\n      this.lightcastTokenExpiryTime = Date.now() + (response.expires_in - 60) * 1000; // -60s for buffer\n\n      return this.lightcastAccessToken;\n    }), catchError(error => {\n      console.error('Error fetching Lightcast access token:', error);\n      this.snackBar.open('Could not authenticate for skills service.', 'Close', {\n        duration: 5000\n      });\n      this.lightcastAccessToken = null;\n      this.lightcastTokenExpiryTime = null;\n      return throwError(() => new Error('Lightcast token fetch failed'));\n    }));\n  }\n\n  searchSkillsFromApi(query) {\n    if (!query || query.length < 2 || this.lightcastClientId === 'YOUR_LIGHTCAST_CLIENT_ID') {\n      return of([]); // Don't call API if query is too short or keys are not set\n    }\n\n    this.isLoadingSkills = true;\n    return this.getLightcastAccessToken().pipe(switchMap(token => {\n      const headers = new HttpHeaders({\n        'Authorization': `Bearer ${token}`\n      }); // Confirm query parameter name with Lightcast, e.g., 'q', 'search', 'filter[name]'\n\n      const params = new HttpParams().set('q', query); // Assuming 'q'\n\n      return this.http.get(this.lightcastSkillsApiUrl, {\n        headers,\n        params\n      }).pipe(map(response => {\n        this.isLoadingSkills = false; // IMPORTANT: Adjust this based on actual Lightcast API response structure\n\n        if (response && Array.isArray(response.data)) {\n          // Example structure\n          return response.data.map(skill => skill.name).slice(0, 10);\n        } else if (Array.isArray(response)) {\n          // Simpler array response\n          return response.map(skill => skill.name || skill).slice(0, 10);\n        }\n\n        console.warn('Unexpected skills API response structure:', response);\n        return [];\n      }), catchError(error => {\n        this.isLoadingSkills = false;\n        console.error('Error fetching Lightcast skills:', error);\n        return of([]);\n      }));\n    }), catchError(() => {\n      this.isLoadingSkills = false;\n      return of([]);\n    }));\n  }\n\n  initializeSkillsInput() {\n    var _a, _b, _c;\n\n    const tagInputEl = (_a = this.tagInputRef) === null || _a === void 0 ? void 0 : _a.nativeElement;\n    const tagContainer = document.getElementById('tagContainer');\n    const skillsSuggestionsDiv = document.getElementById('skillsSuggestions');\n\n    if (!tagInputEl || !tagContainer || !skillsSuggestionsDiv) {\n      console.warn('Skill input DOM elements not fully available for initialization.');\n      return;\n    }\n\n    let selectedTags = [...(((_b = this.jobForm.get('skills')) === null || _b === void 0 ? void 0 : _b.value) || [])];\n    let activeSuggestionIndex = -1;\n    fromEvent(tagInputEl, 'input').pipe(map(event => event.target.value), debounceTime(this.DEBOUNCE_DELAY + 200), // Slightly longer for API\n    distinctUntilChanged(), filter(query => query.length >= 2 || query.length === 0), tap(query => this.isLoadingSkills = query.length >= 2), switchMap(query => query.length >= 2 ? this.searchSkillsFromApi(query) : of([])), tap(() => this.isLoadingSkills = false)).subscribe({\n      next: apiSuggestions => {\n        this.isLoadingSkills = false; // Ensure loading is false\n\n        showAvailableSuggestions(apiSuggestions);\n      },\n      error: err => {\n        this.isLoadingSkills = false;\n        console.error(\"Error in skills input stream:\", err);\n        if (skillsSuggestionsDiv) skillsSuggestionsDiv.style.display = 'none';\n      }\n    });\n\n    const showAvailableSuggestions = filteredSuggestions => {\n      var _a;\n\n      if (!skillsSuggestionsDiv) return;\n      skillsSuggestionsDiv.innerHTML = '';\n\n      if (filteredSuggestions.length === 0 && !this.isLoadingSkills) {\n        skillsSuggestionsDiv.style.display = 'none';\n        return;\n      }\n\n      selectedTags = [...(((_a = this.jobForm.get('skills')) === null || _a === void 0 ? void 0 : _a.value) || [])];\n      const uniqueApiSuggestions = filteredSuggestions.filter(s => !selectedTags.includes(s));\n      uniqueApiSuggestions.forEach(suggestion => {\n        const item = document.createElement('div');\n        item.className = 'suggestion-item';\n        item.textContent = suggestion;\n        item.addEventListener('click', () => {\n          addSkillTag(suggestion);\n          if (tagInputEl) tagInputEl.value = '';\n          skillsSuggestionsDiv.style.display = 'none';\n          if (tagInputEl) tagInputEl.focus();\n        });\n        skillsSuggestionsDiv.appendChild(item);\n      });\n      skillsSuggestionsDiv.style.display = uniqueApiSuggestions.length > 0 ? 'block' : 'none';\n      activeSuggestionIndex = -1;\n    };\n\n    const addSkillTag = text => {\n      var _a;\n\n      if (!tagContainer || !tagInputEl) return;\n      selectedTags = [...(((_a = this.jobForm.get('skills')) === null || _a === void 0 ? void 0 : _a.value) || [])];\n      if (!text || selectedTags.includes(text)) return;\n      selectedTags.push(text);\n      this.jobForm.patchValue({\n        skills: [...selectedTags]\n      });\n      const tag = document.createElement('div');\n      tag.className = 'tag';\n      const tagText = document.createElement('span');\n      tagText.textContent = text;\n      tag.appendChild(tagText);\n      const removeBtn = document.createElement('button');\n      removeBtn.textContent = 'Ã—';\n      removeBtn.addEventListener('click', () => {\n        var _a;\n\n        tag.remove();\n        const currentSkills = ((_a = this.jobForm.get('skills')) === null || _a === void 0 ? void 0 : _a.value) || [];\n        this.jobForm.patchValue({\n          skills: currentSkills.filter(s => s !== text)\n        });\n      });\n      tag.appendChild(removeBtn);\n      tagContainer.insertBefore(tag, tagInputEl);\n    };\n\n    const navigateAvailableSuggestions = direction => {\n      // ... (implementation as before)\n      if (!skillsSuggestionsDiv) return;\n      const items = skillsSuggestionsDiv.querySelectorAll('.suggestion-item');\n      if (items.length === 0) return;\n\n      if (activeSuggestionIndex >= 0 && activeSuggestionIndex < items.length) {\n        // Check bounds\n        items[activeSuggestionIndex].classList.remove('active-suggestion');\n      }\n\n      if (direction === 'down') {\n        activeSuggestionIndex = (activeSuggestionIndex + 1) % items.length;\n      } else {\n        activeSuggestionIndex = (activeSuggestionIndex - 1 + items.length) % items.length;\n      }\n\n      if (activeSuggestionIndex >= 0 && activeSuggestionIndex < items.length) {\n        // Check bounds again\n        items[activeSuggestionIndex].classList.add('active-suggestion');\n        items[activeSuggestionIndex].scrollIntoView({\n          block: 'nearest'\n        });\n      }\n    };\n\n    tagInputEl.addEventListener('keydown', e => {\n      var _a; // ... (implementation as before, ensure null checks for DOM elements)\n\n\n      if (!skillsSuggestionsDiv || !tagContainer || !tagInputEl) return;\n\n      if (e.key === 'Enter') {\n        e.preventDefault();\n        const activeItem = skillsSuggestionsDiv.querySelector('.suggestion-item.active-suggestion');\n        if (activeItem) addSkillTag(activeItem.textContent || '');else if (tagInputEl.value.trim()) addSkillTag(tagInputEl.value.trim());\n        tagInputEl.value = '';\n        skillsSuggestionsDiv.style.display = 'none';\n      } else if (e.key === 'ArrowDown') {\n        e.preventDefault();\n        navigateAvailableSuggestions('down');\n      } else if (e.key === 'ArrowUp') {\n        e.preventDefault();\n        navigateAvailableSuggestions('up');\n      } else if (e.key === 'Backspace' && !tagInputEl.value) {\n        const currentSkills = [...(((_a = this.jobForm.get('skills')) === null || _a === void 0 ? void 0 : _a.value) || [])];\n\n        if (currentSkills.length > 0) {\n          currentSkills.pop();\n          this.jobForm.patchValue({\n            skills: currentSkills\n          });\n          const tagsInDOM = tagContainer.querySelectorAll('.tag');\n          if (tagsInDOM.length > 0) tagsInDOM[tagsInDOM.length - 1].remove();\n        }\n      } else if (e.key === 'Escape') {\n        skillsSuggestionsDiv.style.display = 'none';\n      }\n    });\n    document.addEventListener('click', e => {\n      if (!(tagContainer === null || tagContainer === void 0 ? void 0 : tagContainer.contains(e.target)) && !(skillsSuggestionsDiv === null || skillsSuggestionsDiv === void 0 ? void 0 : skillsSuggestionsDiv.contains(e.target))) {\n        if (skillsSuggestionsDiv) skillsSuggestionsDiv.style.display = 'none';\n      }\n    });\n    tagContainer === null || tagContainer === void 0 ? void 0 : tagContainer.addEventListener('click', e => {\n      if (e.target === tagContainer && tagInputEl) tagInputEl.focus();\n    });\n    this.populateSkills(((_c = this.jobForm.get('skills')) === null || _c === void 0 ? void 0 : _c.value) || []);\n  } // --- Other methods (Google Maps, file upload, form population, etc.) ---\n\n\n  loadGoogleMapsScript() {\n    return new Promise((resolve, reject) => {\n      if (this.googleScriptLoaded) {\n        resolve();\n        return;\n      }\n\n      if (typeof google !== 'undefined' && google.maps && google.maps.places) {\n        this.googleScriptLoaded = true;\n        resolve();\n        return;\n      }\n\n      const script = this.renderer.createElement('script');\n      script.type = 'text/javascript';\n      script.src = `https://maps.googleapis.com/maps/api/js?key=${this.googleMapsApiKey}&libraries=places`;\n      script.async = true;\n      script.defer = true;\n\n      script.onload = () => {\n        this.googleScriptLoaded = true;\n        resolve();\n      };\n\n      script.onerror = error => {\n        console.error('Error loading Google Maps script:', error);\n        reject(error);\n      };\n\n      this.renderer.appendChild(this.document.head, script);\n    });\n  }\n\n  initializeGooglePlacesAutocomplete() {\n    if (typeof google !== 'undefined' && google.maps && google.maps.places && this.locationInput) {\n      if (!this.autocomplete) {\n        this.autocomplete = new google.maps.places.Autocomplete(this.locationInput.nativeElement, {\n          types: ['(cities)']\n        });\n        this.autocomplete.addListener('place_changed', () => {\n          this.ngZone.run(() => {\n            const place = this.autocomplete.getPlace();\n\n            if (place && place.formatted_address) {\n              this.jobForm.patchValue({\n                location: place.formatted_address\n              });\n            } else if (place && place.name) {\n              this.jobForm.patchValue({\n                location: place.name\n              });\n            }\n\n            this.suggestions = [];\n            this.showSuggestions = false;\n          });\n        });\n      }\n    }\n  }\n\n  setupLocationInputListener() {\n    if (!this.locationInput) return;\n    fromEvent(this.locationInput.nativeElement, 'input').pipe(map(event => event.target.value), debounceTime(this.DEBOUNCE_DELAY), distinctUntilChanged(), tap(query => this.isLoading = !!query), switchMap(query => !query || !this.autocomplete ? of([]) : of([]))).subscribe({\n      next: () => this.isLoading = false,\n      error: err => {\n        this.isLoading = false;\n        console.error(\"Error in location input listener:\", err);\n      }\n    });\n  }\n\n  onInput(event) {}\n\n  selectSuggestion(location) {\n    this.jobForm.patchValue({\n      location\n    });\n    this.showSuggestions = false;\n    this.suggestions = [];\n  }\n\n  adjustExperienceRange(min, max) {\n    return min === 0 && max === 0 ? [0, 30] : [min, max];\n  }\n\n  experienceRangeValidator(form) {\n    var _a, _b, _c, _d, _e, _f;\n\n    const totalMin = (_a = form.get('total_experience_min')) === null || _a === void 0 ? void 0 : _a.value;\n    const totalMax = (_b = form.get('total_experience_max')) === null || _b === void 0 ? void 0 : _b.value;\n    const relevantMin = (_c = form.get('relevant_experience_min')) === null || _c === void 0 ? void 0 : _c.value;\n    const relevantMax = (_d = form.get('relevant_experience_max')) === null || _d === void 0 ? void 0 : _d.value;\n    const minBudget = (_e = form.get('min_budget')) === null || _e === void 0 ? void 0 : _e.value;\n    const maxBudget = (_f = form.get('max_budget')) === null || _f === void 0 ? void 0 : _f.value;\n    if (totalMin > totalMax) return {\n      invalidTotalExperience: true\n    };\n    if (relevantMin > relevantMax) return {\n      invalidRelevantExperience: true\n    };\n    if (minBudget !== null && maxBudget !== null && minBudget > maxBudget) return {\n      invalidBudgetRange: true\n    };\n    return null;\n  }\n\n  triggerFileInput() {\n    if (this.fileInput) this.fileInput.nativeElement.click();\n  }\n\n  onFileSelected(event) {\n    this.isFileUploadCompletedSuccessfully = false;\n    const input = event.target;\n\n    if (input.files && input.files.length > 0) {\n      const file = input.files[0];\n      const allowedExtensions = ['.pdf', '.docx', '.txt', '.xml', '.csv', '.doc'];\n      const ext = file.name.toLowerCase().substring(file.name.lastIndexOf('.'));\n      const maxSize = 10 * 1024 * 1024;\n\n      if (!allowedExtensions.includes(ext)) {\n        this.snackBar.open(`Invalid file format. Supported: ${allowedExtensions.join(', ')}`, 'Close', {\n          duration: 5000\n        });\n        this.selectedFile = null;\n        this.displayedFileName = null;\n        if (this.fileInput) input.value = '';\n        return;\n      }\n\n      if (file.size > maxSize) {\n        this.snackBar.open('File size exceeds 10MB limit.', 'Close', {\n          duration: 5000\n        });\n        this.selectedFile = null;\n        this.displayedFileName = null;\n        if (this.fileInput) input.value = '';\n        return;\n      }\n\n      this.selectedFile = file;\n      this.displayedFileName = file.name;\n\n      this._performUpload(this.selectedFile);\n    } else {\n      this.selectedFile = null;\n      this.displayedFileName = null;\n    }\n  }\n\n  _performUpload(file) {\n    if (!file) return;\n    const token = this.corporateAuthService.getJWTToken();\n\n    if (!token) {\n      this.snackBar.open('Authentication required. Please log in.', 'Close', {\n        duration: 5000\n      });\n      this.router.navigate(['/login-corporate']);\n      return;\n    }\n\n    this.isSubmitting = true;\n    this.isFileUploadCompletedSuccessfully = false;\n    this.jobDescriptionService.uploadFile(file, token).subscribe({\n      next: response => {\n        this.jobData = response;\n        this.populateForm(response);\n        this.snackBar.open('File uploaded and processed successfully.', 'Close', {\n          duration: 3000\n        });\n        this.isSubmitting = false;\n        this.isFileUploadCompletedSuccessfully = true;\n        if (this.fileInput) this.fileInput.nativeElement.value = '';\n      },\n      error: error => {\n        console.error('File upload error:', error);\n        this.snackBar.open(`File upload or processing failed: ${error.message || 'Unknown error'}`, 'Close', {\n          duration: 5000\n        });\n        this.isSubmitting = false;\n        this.isFileUploadCompletedSuccessfully = false;\n        if (this.fileInput) this.fileInput.nativeElement.value = '';\n      }\n    });\n  }\n\n  updateExperienceUI() {\n    this.setExperienceRange('total', this.jobForm.value.total_experience_min, this.jobForm.value.total_experience_max);\n    this.setExperienceRange('relevant', this.jobForm.value.relevant_experience_min, this.jobForm.value.relevant_experience_max);\n  }\n\n  populateForm(jobData) {}\n\n  setJobDescription(description) {\n    const editor = document.getElementById('editor');\n\n    if (editor) {\n      editor.innerHTML = description;\n      this.checkEmpty('editor');\n    }\n  }\n\n  updateJobDescriptionFromEditor(event) {\n    const editorContent = event.target.innerHTML;\n    this.jobForm.patchValue({\n      job_description: editorContent\n    });\n    this.checkEmpty('editor');\n  }\n\n  setExperienceRange(type, min, max) {}\n\n  checkEmpty(id) {\n    const element = document.getElementById(id);\n    if (!element) return;\n    element.setAttribute('data-empty', element.innerHTML.trim() === '' || element.innerHTML.trim() === '<br>' ? 'true' : 'false');\n  }\n\n  mapJobType(title) {\n    const lowerTitle = title.toLowerCase();\n    if (lowerTitle.includes('intern')) return 'Internship';\n    if (lowerTitle.includes('contract')) return 'Contract';\n    if (lowerTitle.includes('part-time')) return 'Part-time';\n    return 'Permanent';\n  }\n\n  initializeRange(type) {}\n\n  parseExperience(exp) {\n    const rangeMatch = exp.match(/(\\d+)\\s*-\\s*(\\d+)/);\n    if (rangeMatch) return [parseInt(rangeMatch[1]), parseInt(rangeMatch[2])];\n    const singleMatch = exp.match(/(\\d+)\\s*years?/i);\n\n    if (singleMatch) {\n      const val = parseInt(singleMatch[1]);\n      return [val, val];\n    }\n\n    return [0, 0];\n  }\n\n  handleOutsideClick(event) {\n    setTimeout(() => {\n      if (this.suggestionsContainer && !this.suggestionsContainer.nativeElement.contains(document.activeElement)) {\n        const pacContainer = document.querySelector('.pac-container');\n        if (pacContainer && pacContainer.contains(document.activeElement)) return;\n        this.showSuggestions = false;\n      }\n    }, 150);\n  }\n\n  onSubmit() {\n    if (this.currentStep === 'jobPost') {\n      if (this.jobForm.invalid) {\n        this.snackBar.open('Please fill all required fields correctly.', 'Close', {\n          duration: 5000\n        });\n        this.jobForm.markAllAsTouched();\n        Object.keys(this.jobForm.controls).forEach(key => {\n          var _a, _b;\n\n          if ((_a = this.jobForm.get(key)) === null || _a === void 0 ? void 0 : _a.invalid) {\n            console.log(`Control ${key} is invalid: `, (_b = this.jobForm.get(key)) === null || _b === void 0 ? void 0 : _b.errors);\n          }\n        });\n\n        if (this.jobForm.errors) {\n          console.log('Form-level errors:', this.jobForm.errors);\n        }\n\n        return;\n      }\n\n      const token = this.corporateAuthService.getJWTToken();\n\n      if (!token) {\n        this.snackBar.open('Authentication required. Please log in.', 'Close', {\n          duration: 5000\n        });\n        this.router.navigate(['/login-corporate']);\n        return;\n      }\n\n      this.isSubmitting = true;\n      const formValues = this.jobForm.value;\n      const jobDetails = Object.assign(Object.assign({}, formValues), {\n        skills: {\n          primary: (formValues.skills || []).slice(0, Math.ceil((formValues.skills || []).length / 2)).map(s => ({\n            skill: s,\n            skill_confidence: 0.9,\n            type_confidence: 0.9\n          })),\n          secondary: (formValues.skills || []).slice(Math.ceil((formValues.skills || []).length / 2)).map(s => ({\n            skill: s,\n            skill_confidence: 0.8,\n            type_confidence: 0.8\n          }))\n        },\n        status: 'draft'\n      });\n      this.jobDescriptionService.saveJobPost(jobDetails, token).subscribe({\n        next: response => {\n          this.isSubmitting = false;\n          this.snackBar.open('Job post saved. Proceeding to assessment.', 'Close', {\n            duration: 3000\n          });\n          this.jobForm.patchValue({\n            unique_id: response.unique_id\n          });\n          this.currentStep = 'assessment';\n        },\n        error: error => {\n          this.isSubmitting = false;\n          console.error('Job post saving failed:', error);\n          this.snackBar.open(`Job post saving failed: ${error.message || 'Unknown error'}`, 'Close', {\n            duration: 5000\n          });\n        }\n      });\n    } else if (this.currentStep === 'assessment') {\n      this.isSubmitting = true;\n      setTimeout(() => {\n        this.isSubmitting = false;\n        this.snackBar.open('Assessment details submitted!', 'Close', {\n          duration: 3000\n        });\n        this.resetForm();\n        this.router.navigate(['/job-posted']);\n      }, 1500);\n    }\n  }\n\n  onCancel() {\n    if (this.currentStep === 'assessment') {\n      this.snackBar.open('Returning to job post editing.', 'Close', {\n        duration: 2000\n      });\n      this.currentStep = 'jobPost';\n    } else {\n      this.snackBar.open('Job post creation cancelled.', 'Close', {\n        duration: 3000\n      });\n      this.resetForm();\n      this.router.navigate(['/dashboard']);\n    }\n  }\n\n  resetForm() {\n    this.jobForm.reset({\n      role: '',\n      location: '',\n      job_type: '',\n      workplace_type: '',\n      total_experience_min: 0,\n      total_experience_max: 30,\n      relevant_experience_min: 0,\n      relevant_experience_max: 30,\n      budget_type: '',\n      min_budget: null,\n      max_budget: null,\n      notice_period: '',\n      skills: [],\n      job_description: '',\n      job_description_url: '',\n      unique_id: ''\n    });\n    this.selectedFile = null;\n    if (this.fileInput) this.fileInput.nativeElement.value = '';\n    this.displayedFileName = null;\n    this.isFileUploadCompletedSuccessfully = false;\n    this.populateSkills([]);\n    this.setJobDescription('');\n    this.updateExperienceUI();\n    this.currentStep = 'jobPost';\n    this.jobData = null;\n    this.isSubmitting = false;\n  }\n\n};\n\n__decorate([ViewChild('locationInput')], CreateJobPost1stPageComponent.prototype, \"locationInput\", void 0);\n\n__decorate([ViewChild('suggestionsContainer')], CreateJobPost1stPageComponent.prototype, \"suggestionsContainer\", void 0);\n\n__decorate([ViewChild('fileInput')], CreateJobPost1stPageComponent.prototype, \"fileInput\", void 0);\n\n__decorate([ViewChild('tagInput', {\n  static: false\n})], CreateJobPost1stPageComponent.prototype, \"tagInputRef\", void 0);\n\nCreateJobPost1stPageComponent = __decorate([Component({\n  selector: 'create-job-post-1st-page',\n  templateUrl: './create-job-post-1st-page.component.html',\n  styleUrls: ['./create-job-post-1st-page.component.css']\n}), __param(10, Inject(DOCUMENT))], CreateJobPost1stPageComponent);\nexport { CreateJobPost1stPageComponent };","map":null,"metadata":{},"sourceType":"module"}
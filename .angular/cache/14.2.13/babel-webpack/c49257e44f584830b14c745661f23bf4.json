{"ast":null,"code":"import { HttpHeaders } from '@angular/common/http';\nimport { throwError } from 'rxjs';\nimport { catchError, map } from 'rxjs/operators';\nimport { environment } from '../../environments/environment';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"@angular/common/http\";\nexport let JobDescriptionService = /*#__PURE__*/(() => {\n  class JobDescriptionService {\n    constructor(http) {\n      this.http = http; // Base API URL from environment configuration\n\n      this.apiUrl = environment.apiUrl;\n    }\n    /**\r\n     * Uploads a file to the server\r\n     * @param file The file to upload\r\n     * @param token JWT token for authentication\r\n     * @returns Observable with file URL and unique ID\r\n     */\n\n\n    uploadFile(file, token) {\n      // Validate file input\n      if (!file) {\n        console.error('No file provided for upload');\n        return throwError(() => new Error('No file selected for upload'));\n      } // Create FormData for file upload\n\n\n      const formData = new FormData();\n      formData.append('file', file, file.name); // Set Authorization header with Bearer token\n\n      const headers = new HttpHeaders({\n        Authorization: `Bearer ${token}`\n      });\n      return this.http.post(`${this.apiUrl}file-upload/`, // Matches Django URL: job_post/urls.py -> 'file-upload/'\n      formData, {\n        headers\n      }).pipe(map(response => ({\n        file_url: response.file_url,\n        unique_id: response.unique_id\n      })), catchError(error => this.handleError(error)));\n    }\n    /**\r\n     * Processes job description using AI\r\n     * @param fileUrl URL of the uploaded file\r\n     * @param uniqueId Unique identifier for the file\r\n     * @param token JWT token for authentication\r\n     * @returns Observable with AI-processed job details and MCQs\r\n     */\n\n\n    processJobDescription(fileUrl, uniqueId, token) {\n      // Set headers for JSON request with Bearer token\n      const headers = new HttpHeaders({\n        Authorization: `Bearer ${token}`,\n        'Content-Type': 'application/json'\n      }); // Prepare payload for AI processing\n\n      const payload = {\n        file_url: fileUrl,\n        unique_id: uniqueId\n      };\n      return this.http.post(`${this.apiUrl}ai-process/`, // Matches Django URL: job_post/urls.py -> 'ai-process/'\n      payload, {\n        headers\n      }).pipe(map(response => ({\n        job_details: response.job_details,\n        mcqs: response.mcqs,\n        unique_id: response.unique_id\n      })), catchError(this.handleError));\n    }\n    /**\r\n     * Saves or updates a job post\r\n     * @param jobDetails Job details to save\r\n     * @param token JWT token for authentication\r\n     * @returns Observable indicating success\r\n     */\n\n\n    saveJobPost(jobDetails, token) {\n      // Set headers for JSON request with Bearer token\n      const headers = new HttpHeaders({\n        Authorization: `Bearer ${token}`,\n        'Content-Type': 'application/json'\n      });\n      return this.http.post(`${this.apiUrl}job-post/`, // Corrected to match Django URL: job_post/urls.py -> 'job-post/'\n      jobDetails, {\n        headers\n      }).pipe(catchError(this.handleError));\n    }\n    /**\r\n     * Updates the status of a job post\r\n     * @param jobId ID of the job post to update\r\n     * @param status New status for the job post\r\n     * @param token JWT token for authentication\r\n     * @returns Observable indicating success\r\n     */\n\n\n    updateJobPostStatus(jobId, status, token) {\n      // Set headers for JSON request with Bearer token\n      const headers = new HttpHeaders({\n        Authorization: `Bearer ${token}`,\n        'Content-Type': 'application/json'\n      }); // Prepare payload for status update\n\n      const payload = {\n        job_id: jobId,\n        status\n      };\n      return this.http.post(`${this.apiUrl}job-post/update-status/`, // Matches Django URL: job_post/urls.py -> 'job-post/update-status/'\n      payload, {\n        headers\n      }).pipe(catchError(this.handleError));\n    }\n    /**\r\n     * Deletes a job post\r\n     * @param jobId ID of the job post to delete\r\n     * @param token JWT token for authentication\r\n     * @returns Observable indicating success\r\n     */\n\n\n    deleteJobPost(jobId, token) {\n      // Set headers for JSON request with Bearer token\n      const headers = new HttpHeaders({\n        Authorization: `Bearer ${token}`,\n        'Content-Type': 'application/json'\n      }); // Prepare payload for deletion\n\n      const payload = {\n        job_id: jobId\n      };\n      return this.http.post(`${this.apiUrl}job-post/delete/`, // Matches Django URL: job_post/urls.py -> 'job-post/delete/'\n      payload, {\n        headers\n      }).pipe(catchError(this.handleError));\n    }\n    /**\r\n     * Deletes an uploaded file\r\n     * @param uniqueId Unique identifier of the file to delete\r\n     * @param token JWT token for authentication\r\n     * @returns Observable indicating success\r\n     */\n\n\n    deleteFile(uniqueId, token) {\n      // Set headers for JSON request with Bearer token\n      const headers = new HttpHeaders({\n        Authorization: `Bearer ${token}`,\n        'Content-Type': 'application/json'\n      }); // Prepare payload for file deletion\n\n      const payload = {\n        unique_id: uniqueId\n      };\n      return this.http.post(`${this.apiUrl}file-upload/delete/`, // Matches Django URL: job_post/urls.py -> 'file-upload/delete/'\n      payload, {\n        headers\n      }).pipe(catchError(this.handleError));\n    }\n    /**\r\n     * Handles HTTP errors and formats error messages\r\n     * @param error HTTP error response\r\n     * @returns Observable with formatted error message\r\n     */\n\n\n    handleError(error) {\n      let errorMessage = 'An unknown error occurred';\n\n      if (error.error instanceof ErrorEvent) {\n        // Client-side error\n        errorMessage = `Client-side error: ${error.error.message}`;\n      } else {\n        // Server-side error\n        if (error.status === 401) {\n          errorMessage = 'Unauthorized: Please log in again.';\n        } else if (error.status === 400 && error.error) {\n          // Handle validation errors from Django\n          const errors = error.error;\n          errorMessage = Object.keys(errors).map(key => `${key}: ${errors[key].join(', ')}`).join('; ');\n        } else {\n          errorMessage = `Server error: ${error.status} - ${error.message}`;\n        }\n      } // Log error for debugging\n\n\n      console.error(errorMessage);\n      return throwError(() => new Error(errorMessage));\n    }\n\n  }\n\n  JobDescriptionService.ɵfac = function JobDescriptionService_Factory(t) {\n    return new (t || JobDescriptionService)(i0.ɵɵinject(i1.HttpClient));\n  };\n\n  JobDescriptionService.ɵprov = /*@__PURE__*/i0.ɵɵdefineInjectable({\n    token: JobDescriptionService,\n    factory: JobDescriptionService.ɵfac,\n    providedIn: 'root'\n  });\n  return JobDescriptionService;\n})();","map":null,"metadata":{},"sourceType":"module"}
{"ast":null,"code":"import { HttpHeaders } from '@angular/common/http';\nimport { throwError } from 'rxjs';\nimport { catchError, finalize, tap, retry } from 'rxjs/operators';\nimport { environment } from '../../environments/environment';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"@angular/common/http\";\nimport * as i2 from \"ngx-spinner\";\nexport let EducationService = /*#__PURE__*/(() => {\n  class EducationService {\n    constructor(http, spinner) {\n      this.http = http;\n      this.spinner = spinner;\n      this.apiUrl = environment.apiUrl + 'api/education/';\n      this.referenceDataUrl = environment.apiUrl + 'api/reference-data/';\n    }\n\n    addEducation(educationData) {\n      this.spinner.show();\n      return this.http.post(this.apiUrl, educationData, {\n        withCredentials: true\n      }).pipe(catchError(this.handleError('Add Education')), finalize(() => this.spinner.hide()));\n    }\n\n    getReferenceData() {\n      this.spinner.show();\n      const token = localStorage.getItem('jwtToken');\n\n      if (!token) {\n        console.error('No JWT token found in localStorage');\n        this.spinner.hide();\n        return throwError(() => new Error('Authentication required. Please log in.'));\n      }\n\n      const headers = new HttpHeaders({\n        'Authorization': `Bearer ${token}`\n      });\n      return this.http.get(this.referenceDataUrl, {\n        headers\n      }).pipe(tap(response => console.log('Reference data fetched successfully')), retry(1), // Retry once if the request fails\n      catchError(this.handleError('Get Reference Data')), finalize(() => this.spinner.hide()));\n    }\n\n    handleError(operation) {\n      return error => {\n        console.error(`${operation} failed:`, error);\n        let errorMessage = 'An unknown error occurred';\n\n        if (error.status === 401) {\n          errorMessage = 'Unauthorized: Please log in again';\n        } else if (error.status === 403) {\n          errorMessage = 'Forbidden: You do not have permission to access this resource';\n        } else if (error.status === 404) {\n          errorMessage = 'Not found: The requested resource could not be found';\n        } else if (error.status === 500) {\n          errorMessage = 'Server error: Please try again later';\n        } else if (error.status === 0) {\n          errorMessage = 'Network error: Cannot connect to the server';\n        } else if (error.error && typeof error.error === 'object') {\n          // Extract error message from response if available\n          if (error.error.detail) {\n            errorMessage = error.error.detail;\n          } else if (error.error.message) {\n            errorMessage = error.error.message;\n          }\n        } else if (error.message) {\n          errorMessage = error.message;\n        }\n\n        return throwError(() => new Error(`${operation} failed: ${errorMessage}`));\n      };\n    }\n\n  }\n\n  EducationService.ɵfac = function EducationService_Factory(t) {\n    return new (t || EducationService)(i0.ɵɵinject(i1.HttpClient), i0.ɵɵinject(i2.NgxSpinnerService));\n  };\n\n  EducationService.ɵprov = /*@__PURE__*/i0.ɵɵdefineInjectable({\n    token: EducationService,\n    factory: EducationService.ɵfac,\n    providedIn: 'root'\n  });\n  return EducationService;\n})();","map":null,"metadata":{},"sourceType":"module"}
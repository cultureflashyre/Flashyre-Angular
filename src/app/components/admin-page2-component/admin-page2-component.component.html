<div
  class="admin-page2-component-admin-page2-component"
  [ngClass]="rootClassName"
  >
  <div class="admin-page2-component-container">
    <!-- "JD Extracted" is a button that sets the active view to 'jd'. -->
    <!-- It has an ngClass binding to apply a style when it is the active tab. -->
    <button
      type="button"
      class="admin-page2-component-button button"
      (click)="showJdView()"
      [ngClass]="{'active-tab': activeView === 'jd'}"
      >
      <span class="admin-page2-component-text10">
        JD Extracted
      </span>
    </button>

    <!-- "Candidate Sourced" is a dropdown menu controlling the view and filter. -->
    <div
      data-thq="thq-dropdown"
      class="admin-page2-component-thq-dropdown list-item"
      >
      <div
        data-thq="thq-dropdown-toggle"
        class="admin-page2-component-dropdown-toggle1"
        [ngClass]="{'active-tab': activeView === 'candidates'}"
        >
        <!-- The text of the dropdown button is now dynamic, showing the current filter's display label. -->
        <span class="admin-page2-component-text11">
          {{ candidateFilterDisplay }}
        </span>
        <div
          data-thq="thq-dropdown-arrow"
          class="admin-page2-component-dropdown-arrow"
          >
          <svg viewBox="0 0 1024 1024" class="admin-page2-component-icon1">
            <path d="M426 726v-428l214 214z"></path>
          </svg>
        </div>
      </div>
      <!--
      This dropdown list is now rendered dynamically using *ngFor. It iterates over the
      'candidateFilters' array, which is generated in the component's TypeScript.
      -->
      <ul
        data-thq="thq-dropdown-list"
        class="admin-page2-component-dropdown-list"
        >
        <!-- This single <li> block is a template that gets repeated for each filter option. -->
        @for (filter of candidateFilters; track filter) {
          <li
            data-thq="thq-dropdown"
            class="admin-page2-component-dropdown1 list-item"
            (click)="showCandidatesView(filter.value, filter.label)"
            >
            <div
              data-thq="thq-dropdown-toggle"
              class="admin-page2-component-dropdown-toggle2"
              >
              <!-- The text for each dropdown item is bound to the filter's 'label' property. -->
              <span class="admin-page2-component-text12">
                {{ filter.label }}
              </span>
            </div>
          </li>
        }
      </ul>
    </div>
  </div>

  <!--
  This container uses the async pipe to subscribe to the latestJd$ observable.
  If a JD exists, it unwraps it and makes the activeJobId available for child components.
  -->
  @if (activeJobId) {
    <!-- The JD form is only shown if the view is 'jd' and a JD has been loaded. -->
    @if (activeView === 'jd' && (latestJd$ | async); as jd) {
      <admin-jd-extended-component
        [jobData]="jd"
        [isReadOnly]="true"
      ></admin-jd-extended-component>
    }
    <!-- The candidate list is only shown if the view is 'candidates'. -->
    <!-- It receives the job_id and the selected filter value as inputs. -->
    @if (activeView === 'candidates') {
      <admin-candidate-sourced-component
        [jobId]="activeJobId"
        [filterByDate]="candidateFilterValue"
      ></admin-candidate-sourced-component>
    }
  }

  <!--
  This is a placeholder message that appears if no Job Description has been uploaded yet.
  It is shown conditionally by checking if the latestJd$ observable has emitted a null value.
  -->
  @if (!(latestJd$ | async)) {
    <div class="info-container">
      Please upload a Job Description first to see details and sourced candidates.
    </div>
  }
</div>
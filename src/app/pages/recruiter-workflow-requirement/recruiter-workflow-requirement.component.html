<div class="recruiter-workflow-requirement-container10">
  <div class="recruiter-workflow-requirement-container11">
    <recruiter-workflow-navbar
      rootClassName="recruiter-workflow-navbarroot-class-name3"
    >
      <!-- Navbar ng-templates remain the same -->
      <ng-template #link1>
        <div class="recruiter-workflow-requirement-fragment10">
          <span class="recruiter-workflow-requirement-text10">Home</span>
        </div>
      </ng-template>
      <ng-template #link4>
        <div class="recruiter-workflow-requirement-fragment11">
          <span class="recruiter-workflow-requirement-text11">Requirments</span>
        </div>
      </ng-template>
      <ng-template #text1>
        <div class="recruiter-workflow-requirement-fragment12">
          <span class="recruiter-workflow-requirement-text12">Profile</span>
        </div>
      </ng-template>
      <ng-template #text2>
        <div class="recruiter-workflow-requirement-fragment13">
          <span class="recruiter-workflow-requirement-text13">Preference</span>
        </div>
      </ng-template>
      <ng-template #text3>
        <div class="recruiter-workflow-requirement-fragment14">
          <span class="recruiter-workflow-requirement-text14">Settings</span>
        </div>
      </ng-template>
      <ng-template #text7>
        <div class="recruiter-workflow-requirement-fragment15">
          <span class="recruiter-workflow-requirement-text15">Dashboard</span>
        </div>
      </ng-template>
      <ng-template #text9>
        <div class="recruiter-workflow-requirement-fragment16">
          <span class="recruiter-workflow-requirement-text16">
            Notifications
          </span>
        </div>
      </ng-template>
      <ng-template #text10>
        <div class="recruiter-workflow-requirement-fragment17">
          <span class="recruiter-workflow-requirement-text17">Jobs Posted</span>
        </div>
      </ng-template>
      <ng-template #text11>
        <div class="recruiter-workflow-requirement-fragment18">
          <span class="recruiter-workflow-requirement-text18">Preference</span>
        </div>
      </ng-template>
      <ng-template #text12>
        <div class="recruiter-workflow-requirement-fragment19">
          <span class="recruiter-workflow-requirement-text19">Settings</span>
        </div>
      </ng-template>
      <ng-template #text13>
        <div class="recruiter-workflow-requirement-fragment20">
          <span class="recruiter-workflow-requirement-text20">Logout</span>
        </div>
      </ng-template>
      <ng-template #text14>
        <div class="recruiter-workflow-requirement-fragment21">
          <span class="recruiter-workflow-requirement-text21">2</span>
        </div>
      </ng-template>
      <ng-template #text15>
        <div class="recruiter-workflow-requirement-fragment22">
          <span class="recruiter-workflow-requirement-text22">
            Leslie Alexander
          </span>
        </div>
      </ng-template>
      <ng-template #text16>
        <div class="recruiter-workflow-requirement-fragment23">
          <span class="recruiter-workflow-requirement-text23">Google</span>
        </div>
      </ng-template>
      <ng-template #text31>
        <div class="recruiter-workflow-requirement-fragment24">
          <span class="recruiter-workflow-requirement-text24">Logout</span>
        </div>
      </ng-template>
      <ng-template #text32>
        <div class="recruiter-workflow-requirement-fragment25">
          <span class="recruiter-workflow-requirement-text25">
            <span>Software Development</span>
            <br />
            <span>Mountain View, CA</span>
          </span>
        </div>
      </ng-template>
      <ng-template #text1411>
        <div class="recruiter-workflow-requirement-fragment26">
          <span class="recruiter-workflow-requirement-text29">2</span>
        </div>
      </ng-template>
    </recruiter-workflow-navbar>

    <div class="recruiter-workflow-requirement-requirements-listing-container">
      <div
        id="cv-jd-upload-container"
        class="recruiter-workflow-requirement-cvjd-upload-container"
      >
         <button
          id="add-questions-with-ai-button"
          type="button"
          class="recruiter-workflow-requirement-add-questions-with-ai-button button"
          (click)="showAddForm()"
        >
          <span
            id="add-questions-with-ai-text"
            class="recruiter-workflow-requirement-add-questions-with-ai-text"
          >
            + Add Requirement
          </span>
        </button>
      </div>
      
      <!-- Main Listing Container -->
      <!-- Main Listing Container -->
      <div class="recruiter-workflow-requirement-recruiter-workflow-requirment-listing">
        
        <!-- 1. SHOW CONTROLS IF ANY DATA EXISTS IN DB (Even if filtered list is empty) -->
        <ng-container *ngIf="masterRequirements.length > 0">
          <!-- Top Bar: Filter, Sort, Download (Static Header) -->
          <div
            id="select-filter-sort-download-zip-main-container"
            class="recruiter-workflow-requirement-select-filter-sort-download-zip-main-container"
          >
            <!-- ... (Keep your existing Header content exactly as it is) ... -->
            <div class="recruiter-workflow-requirement-container28">
              <div
                id="select-all-main-container"
                class="recruiter-workflow-requirement-select-all-main-container1"
              >
                <input
                  type="checkbox"
                  id="select-checkbox-master"
                  class="recruiter-workflow-requirement-select-checkbox1"
                  [(ngModel)]="isAllSelected"
                  (change)="toggleSelectAll()"
                />
                <span
                  id="select-all-text"
                  class="recruiter-workflow-requirement-select-all-text"
                >
                  Select All
                </span>
              </div>
            </div>
            <div
              id="filter-sort-download-zip-container"
              class="recruiter-workflow-requirement-filter-sort-download-zip-container"
            > 
              <div class="bulk-status-container" *ngIf="isAnySelected" style="margin-right: 15px;">
                <select 
                    class="bulk-status-select"
                    [(ngModel)]="bulkStatusSelected"
                    (change)="onBulkStatusChange($event)"
                >
                    <option value="" disabled selected>Change Status</option>
                    <option *ngFor="let opt of statusOptions" [value]="opt.label">
                      Set to {{ opt.label }}
                    </option>
                </select>
              </div>
              <button
              *ngIf="isSuperUser"
                id="filtered-button"
                type="button"
                class="recruiter-workflow-requirement-filtered-button1 button"
                (click)="deleteSelectedRequirements()"
              >
                <span id="start-process-text" class="recruiter-workflow-requirement-start-process-text1">
                  Delete
                </span>
              </button>
              <div id="filtered-container" class="recruiter-workflow-requirement-filtered-container" style="position: relative;">
                <button
                  (click)="toggleFilterPanel()"
                  id="filtered-button"
                  type="button"
                  class="recruiter-workflow-requirement-filtered-button2 button"
                >
                  <span id="start-process-text" class="recruiter-workflow-requirement-start-process-text2">
                    Filtered By
                  </span>
                </button>
                <div *ngIf="isFilterPanelVisible" class="filter-panel">
                  <form [formGroup]="filterForm" class="filter-form-grid">
                    <div class="filter-group">
                      <label for="filter-client">Client Name</label>
                      <input id="filter-client" type="text" formControlName="client_name" placeholder="Filter by client..." class="input">
                    </div>
                    <div class="filter-group">
                      <label for="filter-location">Location</label>
                      <input id="filter-location" type="text" formControlName="location" placeholder="Filter by location..." class="input">
                    </div>
                    <div class="filter-group">  
                      <label for="filter-desc">Description / Skills</label>
                      <input id="filter-desc" type="text" formControlName="description" placeholder="e.g. Python, Java" class="input">
                    </div>
                    <div class="filter-group">
                      <label for="filter-role">Role</label>
                      <input id="filter-role" type="text" formControlName="role" placeholder="Filter by role..." class="input">
                    </div>
                   
                  </form>
                  <div class="filter-panel-actions">
                    <button type="button" (click)="clearFilters()" class="button clear-button">Clear</button>
                    <button type="button" (click)="applyFiltersFromPanel()" class="button apply-button">Apply</button>
                  </div>
                </div>
              </div>
              <div class="recruiter-workflow-requirement-sort-dropdown list-item">
                <select 
                  class="recruiter-workflow-requirement-dropdown-toggle1" 
                  (change)="sortRequirementsChange($event)"
                  style="cursor: pointer; padding-right: 20px;"
                >
                  <option value="none" selected>Sort</option>
                  <option value="a-z">Alphabetical (A-Z)</option>
                  <option value="z-a">Alphabetical (Z-A)</option>
                </select>
              </div>
            </div>
          </div>
        </ng-container>

        <!-- 2. SHOW LIST IF MATCHES FOUND -->
        <ng-container *ngIf="requirementsList.length > 0">
          <div class="large-container">
            <!-- ... (Keep your existing *ngFor loop for items exactly as it is) ... -->
            <div 
              class="recruiter-workflow-requirement-container31" 
              *ngFor="let item of requirementsList; let i = index" 
              [id]="'requirement-card-' + i"
            >
             <!-- ... (Card Content) ... -->
             <div class="recruiter-workflow-requirement-container32">
                <!-- Keep all inner card content same as your original code -->
                <div class="recruiter-workflow-requirement-container33">
                  <div class="recruiter-workflow-requirement-container34">
                    <div class="recruiter-workflow-requirement-container35">
                      <input
                        type="checkbox"
                        id="select-checkbox-{{i}}"
                        class="recruiter-workflow-requirement-select-checkbox2"
                        [(ngModel)]="item.selected"
                        (change)="checkIfAllSelected()"
                      />
                    </div>
                    <div class="recruiter-workflow-requirement-container36">
                      <div style="display: flex; gap: 16px; align-items: flex-start; width: auto;">
                      <span class="recruiter-workflow-requirement-text55">
                        {{ item.job_role }}
                      </span>
                      <div class="status-badge-container">
                        <div 
                            class="status-badge" 
                            [style.background-color]="getStatusColor(item.status)"
                            [style.border-color]="getStatusColor(item.status)"
                            (click)="toggleStatusPopover(item, $event)"
                        >
                            <span class="status-text">{{ item.status || 'Active' }}</span>
                            <span class="status-arrow">▼</span>
                        </div>

                        <!-- POPOVER MENU -->
                        <ul class="status-popover" *ngIf="item.showStatusDropdown">
                            <li 
                                *ngFor="let opt of statusOptions" 
                                (click)="updateSingleStatus(item, opt.label, $event)"
                                [class.selected-option]="item.status === opt.label"
                            >
                                <span class="dot" [style.background-color]="opt.color"></span>
                                {{ opt.label }}
                            </li>
                        </ul>
                      </div>
                    </div> 
                      <div class="recruiter-workflow-requirement-container37">
                        <div class="recruiter-workflow-requirement-container38">
                          <svg
                            width="24" height="24" viewBox="0 0 24 24"
                            class="recruiter-workflow-requirement-icon22"
                          >
                            <g fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                              <rect x="2" y="7" rx="2" ry="2" width="20" height="14"></rect>
                              <path d="M16 21V5a2 2 0 0 0-2-2h-4a2 2 0 0 0-2 2v16"></path>
                            </g>
                          </svg>
                          <span class="recruiter-workflow-requirement-text56">
                            {{ item.total_experience_min }} - {{ item.total_experience_max }} years
                          </span>
                        </div>
                        <div class="recruiter-workflow-requirement-container39">
                          <svg
                            width="24" height="24" viewBox="0 0 24 24"
                            class="recruiter-workflow-requirement-icon26"
                          >
                            <path
                              d="M5 3a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-2.28A2 2 0 0 0 22 15V9a2 2 0 0 0-1-1.72V5a2 2 0 0 0-2-2zm0 2h14v2h-6a2 2 0 0 0-2 2v6a2 2 0 0 0 2 2h6v2H5zm8 4h7v6h-7zm3 1.5a1.5 1.5 0 0 0-1.5 1.5a1.5 1.5 0 0 0 1.5 1.5a1.5 1.5 0 0 0 1.5-1.5a1.5 1.5 0 0 0-1.5-1.5"
                              fill="currentColor"
                            ></path>
                          </svg>
                          <span class="recruiter-workflow-requirement-text57">
                            {{ item.salary_min }} - {{ item.salary_max }}
                          </span>
                        </div>
                        <div class="recruiter-workflow-requirement-container40">
                          <svg
                            width="24" height="24" viewBox="0 0 24 24"
                            class="recruiter-workflow-requirement-icon28"
                          >
                            <g fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                              <circle r="3" cx="12" cy="10"></circle>
                              <path d="M12 2a8 8 0 0 0-8 8c0 1.892.402 3.13 1.5 4.5L12 22l6.5-7.5c1.098-1.37 1.5-2.608 1.5-4.5a8 8 0 0 0-8-8"></path>
                            </g>
                          </svg>
                          <span class="recruiter-workflow-requirement-text58">
                            {{ item.interview_location }}
                          </span>
                        </div>
                      </div>
                      <div class="recruiter-workflow-requirement-container41">
                        <div class="recruiter-workflow-requirement-container42">
                          <span class="recruiter-workflow-requirement-text59">Client</span>
                          <span class="recruiter-workflow-requirement-text60">{{ item.client_name }}</span>
                        </div>
                        <div class="recruiter-workflow-requirement-container43">
                          <span class="recruiter-workflow-requirement-text61">Sub Client</span>
                          <span class="recruiter-workflow-requirement-text62">{{ item.sub_client_name }}</span>
                        </div>
                        <div class="recruiter-workflow-requirement-container44">
                          <span class="recruiter-workflow-requirement-text63">Skills/Desc</span>
                          <div class="recruiter-workflow-requirement-container45">
                            <span class="recruiter-workflow-requirement-text64">
                              {{ item.isExpanded ? item.job_description : (item.job_description | slice:0:100) }}
                              {{ !item.isExpanded && item.job_description.length > 100 ? '...' : '' }}
                            </span>
                            <span class="recruiter-workflow-requirement-text65"
                              *ngIf="item.job_description.length > 100"
                              (click)="toggleDescription(item)"
                              style="cursor: pointer;  margin-left: 5px;"
                            >
                              {{ item.isExpanded ? '... less' : '... more' }}
                            </span>
                          </div>
                        </div>
                        <div class="recruiter-workflow-requirement-container48">
                          <!-- CHECK IF DETAILS EXIST -->
                          <ng-container *ngIf="item.location_details && item.location_details.length > 0; else noDetailsBlock">
                            <div class="recruiter-workflow-requirement-container49">
                              <div class="recruiter-workflow-requirement-container50">
                                <h1 class="recruiter-workflow-requirement-text69">Location</h1>
                              </div>
                              <div class="recruiter-workflow-requirement-container51">
                                <h1 class="recruiter-workflow-requirement-text70">Spoc</h1>
                              </div>
                              <div class="recruiter-workflow-requirement-container52">
                                <h1 class="recruiter-workflow-requirement-text71">Number of Vacencies</h1>
                              </div>
                            </div>
                            <div class="recruiter-workflow-requirement-container53">
                              <div 
                                class="recruiter-workflow-requirement-container54"
                                *ngFor="let loc of item.location_details"
                              >
                                <div class="recruiter-workflow-requirement-container55">
                                  <span class="recruiter-workflow-requirement-text72">{{ loc.location }}</span>
                                </div>
                                <div class="recruiter-workflow-requirement-container56">
                                  <span class="recruiter-workflow-requirement-text73">{{ loc.spoc_name }}</span>
                                </div>
                                <div class="recruiter-workflow-requirement-container57">
                                  <span class="recruiter-workflow-requirement-text74">{{ loc.vacancies }}</span>
                                </div>
                              </div>
                            </div>
                          </ng-container>

                          <!-- TEMPLATE FOR NO DATA -->
                          <ng-template #noDetailsBlock>
                             <div style="width: 100%; display: flex; justify-content: center; align-items: center; padding: 20px; color: #747474; font-size: 14px;">
                                No information provided in Additional Details.
                             </div>
                          </ng-template>
                        </div>
                      </div>
                    </div>
                  </div>
                  <div class="recruiter-workflow-requirement-container58">
                    <svg
                      viewBox="0 0 1024 1024"
                      class="recruiter-workflow-requirement-icon32"
                      (click)="onEdit(item)"
                    >
                      <path d="M761.1 288.3L687.8 215L325.1 577.6l-15.6 89l88.9-15.7z" fill="currentColor" fill-opacity=".15"></path>
                      <path d="M880 836H144c-17.7 0-32 14.3-32 32v36c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-36c0-17.7-14.3-32-32-32m-622.3-84c2 0 4-.2 6-.5L431.9 722c2-.4 3.9-1.3 5.3-2.8l423.9-423.9a9.96 9.96 0 0 0 0-14.1L694.9 114.9c-1.9-1.9-4.4-2.9-7.1-2.9s-5.2 1-7.1 2.9L256.8 538.8c-1.5 1.5-2.4 3.3-2.8 5.3l-29.5 168.2a33.5 33.5 0 0 0 9.4 29.8c6.6 6.4 14.9 9.9 23.8 9.9m67.4-174.4L687.8 215l73.3 73.3l-362.7 362.6l-88.9 15.7z" fill="currentColor"></path>
                    </svg>
                    <span
                        class="recruiter-workflow-requirement-ats-text"
                        (click)="navigateToAts(item.id)"
                        title="Go to ATS"
                        style="cursor: pointer; font-weight: 700; font-size: 14px; color: #05356C;"
                    >
                        ATS
                    </span>
                    <svg
                      *ngIf="isSuperUser"
                      viewBox="0 0 20 20"
                      class="recruiter-workflow-requirement-icon37"
                      (click)="deleteCardFromUi(i)"
                    >
                      <path d="M8.5 4h3a1.5 1.5 0 0 0-3 0m-1 0a2.5 2.5 0 0 1 5 0h5a.5.5 0 0 1 0 1h-1.054l-1.194 10.344A3 3 0 0 1 12.272 18H7.728a3 3 0 0 1-2.98-2.656L3.554 5H2.5a.5.5 0 0 1 0-1zM5.741 15.23A2 2 0 0 0 7.728 17h4.544a2 2 0 0 0 1.987-1.77L15.439 5H4.561zM8.5 7.5A.5.5 0 0 1 9 8v6a.5.5 0 0 1-1 0V8a.5.5 0 0 1 .5-.5M12 8a.5.5 0 0 0-1 0v6a.5.5 0 0 0 1 0z" fill="currentColor"></path>
                    </svg>
                  </div>
                </div>
                <div class="recruiter-workflow-requirement-container59">
                  <div class="recruiter-workflow-requirement-container60">
                    <span class="recruiter-workflow-requirement-text75">Recruiter :&nbsp;</span>
                    <span class="recruiter-workflow-requirement-text76">
                      <ng-container *ngIf="item.created_by_details; else unassigned">
                        {{ item.created_by_details.first_name }} {{ item.created_by_details.last_name }}
                      </ng-container>
                      <ng-template #unassigned>Unassigned</ng-template>
                    </span>
                  </div>
                  <div class="recruiter-workflow-requirement-container61">
                    <span class="recruiter-workflow-requirement-text77">Created at :&nbsp;</span>
                    <span class="recruiter-workflow-requirement-text78">{{ item.created_at | date:'mediumDate' }}</span>
                  </div>
                  <div class="assigned-users-display" *ngIf="item.assigned_users_details && item.assigned_users_details.length > 0">
                    <div class="user-avatar-small" *ngFor="let user of item.assigned_users_details | slice:0:3" title="{{ user.first_name }} {{ user.last_name }}">
                      {{ user.initials || (user.first_name | slice:0:1) }}
                    </div>
                    <div class="user-avatar-small more-users-badge" *ngIf="item.assigned_users_details.length > 3">
                      +{{ item.assigned_users_details.length - 3 }}
                    </div>
                  </div>
                  <div class="assigned-users-display" *ngIf="!item.assigned_users_details || item.assigned_users_details.length === 0">
                    <span style="font-size: 12px; color: #999;">Unassigned</span>
                  </div>
                </div>
              </div>

            </div>
          </div>
        </ng-container>

        <!-- 3. SHOW 'NO MATCHES' IF DB HAS DATA BUT FILTER FOUND NOTHING -->
        <ng-container *ngIf="masterRequirements.length > 0 && requirementsList.length === 0">
          <div style="text-align: center; align-self: center; padding: 40px; display: flex; flex-direction: column; align-items: center; justify-content: center;">
            <svg xmlns="http://www.w3.org/2000/svg" width="64" height="64" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1" stroke-linecap="round" stroke-linejoin="round" style="color: #6b7280; margin-bottom: 16px;">
              <circle cx="11" cy="11" r="8"></circle>
              <line x1="21" y1="21" x2="16.65" y2="16.65"></line>
            </svg>
            <h3 style="font-size: 1.125rem; font-weight: 600; color: #111827; margin-bottom: 8px;">No Matches Found</h3>
            <p style="color: #6b7280; margin-bottom: 24px;">No requirements match your current filter criteria.</p>
            <button 
              (click)="clearFilters()" 
              type="button" 
              class="recruiter-workflow-requirement-filtered-button2 button" 
              style="width: auto; padding: 8px 20px; color: #05356c; background-color: white;"
            >
              Clear Filters
            </button>
          </div>
        </ng-container>

        <!-- 4. SHOW 'NO DATA' ONLY IF DB IS EMPTY -->
        <div 
          *ngIf="masterRequirements.length === 0" 
          style="text-align: center; padding: 50px; font-size: 18px; color: #666; width: 100%; display: flex; justify-content: center;"
        >
          <span>No Data is Present</span>
        </div>
      </div>
    </div>
  </div>

  <app-alert-message
    *ngIf="showAlert"
    [message]="alertMessage"
    [buttons]="alertButtons"
    (buttonClicked)="onAlertButtonClick($event)"
    (close)="closeAlert()"
  >
  </app-alert-message>
</div>

<!-- ============================================= -->
<!-- === FORM MODAL OVERLAY === -->
<!-- ============================================= -->
<ng-container *ngIf="isFormVisible">
  <div class="form-modal-backdrop" (click)="onCancel()"></div>
  
  <div class="form-modal-container">
    <div class="recruiter-workflow-requirement-requirment-listing-form">
      <div class="recruiter-workflow-requirement-container12">
        <span class="recruiter-workflow-requirement-text30">{{ isEditMode ? 'Edit Requirement' : 'Input form' }}</span>
        <div 
          class="close-icon-container" 
          (click)="onCancel()"
          style="cursor: pointer; padding: 5px;"
          title="Close Form"
        >
          <svg
            width="24" height="24" viewBox="0 0 1024 1024"
            style="fill: #555; transition: transform 0.2s;"
            onmouseover="this.style.fill='#000'; this.style.transform='scale(1.1)'"
            onmouseout="this.style.fill='#555'; this.style.transform='scale(1)'"
          >
            <path d="M563.8 512l262.5-312.9c4.4-5.2.7-13.1-6.1-13.1h-79.8c-4.7 0-9.2 2.1-12.3 5.7L511.6 449.8 295.1 191.7c-3-3.6-7.5-5.7-12.3-5.7H203c-6.8 0-10.5 7.9-6.1 13.1L459.4 512 196.9 824.9A7.95 7.95 0 0 0 203 838h79.8c4.7 0 9.2-2.1 12.3-5.7l216.5-258.1 216.5 258.1c3 3.6 7.5 5.7 12.3 5.7h79.8c6.8 0 10.5-7.9 6.1-13.1L563.8 512z"></path>
          </svg>
        </div>
      </div>
      <div class="recruiter-workflow-requirement-container14">
        <div id="upload-file-container" class="recruiter-workflow-requirement-upload-file-container">
          <input type="text" id="upload-file-input" placeholder="Select PDF or Word file (Max 5MB)" class="recruiter-workflow-requirement-upload-file-input input" [value]="getFileName()" readonly />
          <input type="file" id="file-upload-input" (change)="onFileSelected($event)" accept=".pdf,.doc,.docx,application/msword,application/vnd.openxmlformats-officedocument.wordprocessingml.document" style="display: none" />
          <label for="file-upload-input" id="upload-file-button-container" class="recruiter-workflow-requirement-upload-file-button-container" style="cursor: pointer">
            <svg width="48" height="48" viewBox="0 0 48 48" class="recruiter-workflow-requirement-icon10">
              <path d="M11.678 20.271C7.275 21.318 4 25.277 4 30c0 5.523 4.477 10 10 10c.947 0 1.864-.132 2.733-.378m19.322-19.351c4.403 1.047 7.677 5.006 7.677 9.729c0 5.523-4.477 10-10 10c-.947 0-1.864-.132-2.732-.378M36 20c0-6.627-5.373-12-12-12s-12 5.373-12 12m5.065 7.881L24 20.924L31.132 28M24 38V24.462" fill="none" stroke="currentColor" stroke-width="4" stroke-linecap="round" stroke-linejoin="round"></path>
            </svg>
            <span class="recruiter-workflow-requirement-text33">Upload File</span>
          </label>
        </div>
        <div *ngIf="fileUploadError" class="error-text" style="margin-top: -10px; margin-bottom: 10px; text-align: left; width: 100%;">{{ fileUploadError }}</div>
        <span id="note-for-file" class="recruiter-workflow-requirement-note-for-file">Note: Maximum file size is 5MB. Supported formats are PDF and Word documents.</span>
      </div>
      <div class="recruiter-workflow-requirement-container15">
        <div id="enter-manually-text-container" class="recruiter-workflow-requirement-enter-manually-text-container">
          <span id="enter-manually-text" class="recruiter-workflow-requirement-enter-manually-text">Enter Manually</span>
        </div>
        <div id="job-title-company-name-container" class="recruiter-workflow-requirement-job-title-company-name-container1">
          <div id="candidate-job-title" class="recruiter-workflow-requirement-job-title-container1">
            <span id="employment-job-title-text" class="recruiter-workflow-requirement-job-title-text1">Client <span style="color: red;">*</span></span>
            <select 
              id="employment-job-title-input" 
              class="recruiter-workflow-requirement-job-title-input1 input" 
              [(ngModel)]="clientName" 
              (change)="onClientChange()"
              (ngModelChange)="isClientNameInvalid = false"
              style="background: transparent;">
              <option value="" disabled selected>Select Client Name</option>
              <option *ngFor="let c of clientList" [value]="c.client_name">{{ c.client_name }}</option>
            </select>
            <span *ngIf="formErrors.client_name" class="inline-error-text">{{ formErrors.client_name }}</span>
            <span *ngIf="isClientNameInvalid" class="error-text" style="color: red; font-size: 12px; margin-top: 4px; display: block;">
              Client Name is required.
            </span>
          </div>
          <div id="candidate-company-name-container" class="recruiter-workflow-requirement-company-name-container1">
            <span id="employment-company-name" class="recruiter-workflow-requirement-company-name-text1">Sub Client</span>
            <select 
              id="employment-company-name-input" 
              class="recruiter-workflow-requirement-company-name-input1 input" 
              [(ngModel)]="subClientName"
              style="background: transparent;">
              <option value="" selected>Select Sub Client</option>
              <option *ngFor="let sc of availableSubClients" [value]="sc">{{ sc }}</option>
            </select>
          </div>
          
        </div>
        <div id="issued-renewal-date-container" class="recruiter-workflow-requirement-issued-renewal-date-container1">
          <div id="certification-issued-date-container" class="recruiter-workflow-requirement-issued-date-container1">
            <div id="container" class="recruiter-workflow-requirement-container16">
              <span id="certificate-issued-date" class="recruiter-workflow-requirement-issuing-date-text1"><span>Total Experience <span style="color: red;">*</span></span><br /></span>
              <div id="select-container" class="recruiter-workflow-requirement-select-container1">
                <div class="recruiter-workflow-requirement-container17">
                  <input 
                    type="number" 
                    id="total-exp-min" 
                    placeholder="Min Experience" 
                    class="recruiter-workflow-requirement-company-name-input2 input" 
                    [ngClass]="{'input-error': errors.totalExpRange}" 
                    [(ngModel)]="experience.totalMin" 
                    (input)="validateExperience($event)"  
                    min="0" 
                  />
                </div>
                <span>To</span>
                <div class="recruiter-workflow-requirement-container18">
                  <input 
                    type="number" 
                    id="total-exp-max" 
                    placeholder="Max Experience" 
                    class="recruiter-workflow-requirement-company-name-input3 input" 
                    [ngClass]="{'input-error': errors.totalExpRange}" 
                    [(ngModel)]="experience.totalMax" 
                    (input)="validateExperience($event)"  
                    min="0" 
                  />
                </div>
                <span>Years</span>
              </div>
              
              <!-- Existing Required Error -->
              <div *ngIf="isTotalExpInvalid" class="error-text" style="color: red; font-size: 12px; margin-top: 5px;">
                Total Experience is required.
              </div>

              <!-- NEW ERROR MESSAGE FOR RANGE -->
              <div *ngIf="errors.totalExpRange" class="error-text" style="margin-top: 5px;">
                Min Total Experience cannot be greater than Max Total Experience.
              </div>
            </div>
            <div *ngIf="isTotalExpInvalid" class="error-text" style="color: red; font-size: 12px; margin-top: 5px;">
    Total Experience is required.
  </div>
          </div>
          <div id="certification-renewal-date-input" class="recruiter-workflow-requirement-renewal-date-container">
            <div id="certification-renewal-date-container" class="recruiter-workflow-requirement-container19">
              <span id="certificate-renewal-date-text" class="recruiter-workflow-requirement-renewal-date-text"><span>Relavant Experience  <span style="color: red;">*</span></span><br /></span>
              <div id="select-container" class="recruiter-workflow-requirement-select-container2">
                <div class="recruiter-workflow-requirement-container20"><input type="number" id="rel-exp-min" placeholder="Min Experience" class="recruiter-workflow-requirement-company-name-input4 input" [ngClass]="{'input-error': errors.minExperience}" [(ngModel)]="experience.relevantMin" (input)="validateExperience($event)"  min="0" /></div>
                <span>To</span>
                <div class="recruiter-workflow-requirement-container21"><input type="number" id="rel-exp-max" placeholder="Max Experience" class="recruiter-workflow-requirement-company-name-input5 input" [ngClass]="{'input-error': errors.maxExperience}" [(ngModel)]="experience.relevantMax" (input)="validateExperience($event)"  min="0" /></div>
                <span>Years</span>
              </div>
              <div *ngIf="isRelevantExpInvalid" class="error-text" style="color: red; font-size: 12px; margin-top: 5px;">
        Relevant Experience is required.
    </div>
              <div *ngIf="errors.minExperience || errors.maxExperience" style="margin-top: 5px;">
                <span *ngIf="errors.minExperience" class="error-text">Min Relevant Experience cannot be greater than Total Min Experience.</span>
                <span *ngIf="errors.maxExperience" class="error-text">Max Relevant Experience cannot be greater than Total Max Experience.</span>
              </div>
            </div>
          </div>
        </div>
        <div id="issued-renewal-date-container" class="recruiter-workflow-requirement-issued-renewal-date-container2">
          <div id="certification-issued-date-container" class="recruiter-workflow-requirement-issued-date-container2">
            <div id="container" class="recruiter-workflow-requirement-container22">
              <span id="certificate-issued-date" class="recruiter-workflow-requirement-issuing-date-text2"><span>Salary  <span style="color: red;">*</span></span><br /></span>
              <div id="select-container" class="recruiter-workflow-requirement-select-container3">
                <div class="recruiter-workflow-requirement-container23"><input type="number" id="salary-min" placeholder="Min Salary" class="recruiter-workflow-requirement-company-name-input6 input" [ngClass]="{'input-error': salaryErrors.rangeError}" [(ngModel)]="salary.min" (input)="validateSalary()" min="0" /></div>
                <span>To</span>
                <div class="recruiter-workflow-requirement-container24"><input type="number" id="salary-max" placeholder="Max Salary" class="recruiter-workflow-requirement-company-name-input7 input" [ngClass]="{'input-error': salaryErrors.rangeError}" [(ngModel)]="salary.max" (input)="validateSalary()" min="0" /></div>
                <span>LPA</span>
              </div>
            </div>
            <div *ngIf="salaryErrors.rangeError" style="margin-top: 5px;"><span class="error-text">Min Salary cannot be greater than Max Salary.</span></div>
          </div>
         <div class="recruiter-workflow-requirement-certificate-name-container">
            <div class="recruiter-workflow-requirement-certifiacate-name-container">
                <span class="recruiter-workflow-requirement-certificate-name-text">
                    Job Role <span style="color: red;">*</span>
                    <span class="recruiter-workflow-requirement-skill-star-text" style="font-size: 1em;">*</span>
                </span>
                <input
                    type="text"
                    placeholder="Enter Job Role"
                    class="recruiter-workflow-requirement-job-title-input1 input"
                    [(ngModel)]="jobRole"
                    [ngClass]="{'input-error': isJobRoleInvalid || isJobRoleNumericOnly}"
                    (input)="validateJobRoleInput($event)"
                />
                <span *ngIf="formErrors.job_role" class="inline-error-text">{{ formErrors.job_role }}</span>
                <span *ngIf="isJobRoleInvalid" class="error-text" style="color: red; font-size: 12px; margin-top: 4px; display: block;">
                  Job Role is required.
                </span>
                <span *ngIf="isJobRoleNumericOnly" class="error-text" style="color: red; font-size: 12px; margin-top: 4px; display: block;">
                   Job Role cannot contain only numbers. Please include alphabets.
                </span>
            </div>
        </div>
        </div>
        
        <!-- NEW CONTAINER FOR ASSIGN TO AND LOCATION -->
        <!-- Row 1: Interview Date + Interview Location -->
<div class="assigned-and-job-title">
  
  <!-- 1. INTERVIEW DATE (Swapped to Left) -->
  <div class="recruiter-workflow-requirement-company-name-container2" style="width: 49%">
    <span id="employment-company-name" class="recruiter-workflow-requirement-company-name-text2">Interview Date <span style="color: red;">*</span></span>
    <input type="date" id="employment-company-name-input" placeholder="Enter Date" class="recruiter-workflow-requirement-company-name-input8 input" [(ngModel)]="interviewDate" (ngModelChange)="isInterviewDateInvalid = false" [min]="minDate" />
    <span *ngIf="isInterviewDateInvalid" class="error-text" style="color: red; font-size: 12px; margin-top: 4px;">
      Interview Date is required.
    </span>
  </div>

  <!-- 2. ADVANCED INTERVIEW LOCATION (Remains on Right) -->
  <div class="recruiter-workflow-requirement-job-title-container2" style="position:relative; width: 49%;">
      <span id="employment-job-title-text" class="recruiter-workflow-requirement-job-title-text2">Interview Location <span style="color: red;">*</span></span>
      
      <div class="skills-input-container">
          <span *ngFor="let loc of interviewLocationsList; let i = index" class="skill-pill">
            {{ loc }}
            <button type="button" class="remove-skill-button" (click)="removeInterviewLocation(i)">&times;</button>
          </span>
          <input 
              #locInput
              type="text" 
              class="skills-entry-input" 
              placeholder="Search City..." 
              (input)="onInterviewLocationInput($event)"
              (keydown.enter)="addManualInterviewLocation($event)"
          />
      </div>
      <div *ngIf="isInterviewLocationInvalid" class="error-text" style="color: red; font-size: 12px; margin-top: 4px;">
        Interview Location is required.
      </div>
      
      <div class="location-suggestions-dropdown" *ngIf="showInterviewLocationSuggestions && interviewLocationSuggestions.length > 0">
          <div 
            class="suggestion-item" 
            *ngFor="let suggestion of interviewLocationSuggestions"
            (click)="selectInterviewLocation(suggestion, locInput)"
          >
            {{ suggestion.description }}
          </div>
      </div>
  </div>
</div>

        <!-- INTERVIEW DATE (On its own row now) -->
        <!-- Row 2: Assign To (Swapped Here) -->
<div class="recruiter-workflow-requirement-job-title-company-name-container2">
    <!-- ASSIGN TO (Super User only) -->
    <div *ngIf="isSuperUser" style="width: 49%;" class="recruiter-workflow-requirement-job-title-container1">
      <span class="recruiter-workflow-requirement-skill-text">Assign To</span>
      <div class="multi-select-container" (click)="filterUsers()">
        <div class="selected-user-chip" *ngFor="let user of selectedAssignees; let i = index">
          {{ user.first_name }} {{ user.last_name }}
          <span class="remove-chip-icon" (click)="removeUser(i); $event.stopPropagation()">×</span>
        </div>
        <input type="text" class="multi-select-input" placeholder="Search Admins/Recruiters..." [(ngModel)]="userSearchText" (input)="filterUsers()" (focus)="filterUsers()" (blur)="closeUserDropdown()" [ngModelOptions]="{standalone: true}" />
        <ul class="users-dropdown-list" *ngIf="isUserDropdownOpen && filteredUsers.length > 0">
          <li class="users-dropdown-item" *ngFor="let user of filteredUsers" (mousedown)="selectUser(user)">
            <span>{{ user.first_name }} {{ user.last_name }}</span>
            <span class="dropdown-user-role">{{ user.user_type }}</span>
          </li>
        </ul>
        <div class="users-dropdown-list" *ngIf="isUserDropdownOpen && filteredUsers.length === 0" style="padding:10px; color:#999;">No matching users found.</div>
      </div>
    </div>
</div>

        

        <!-- ... rest of your form fields (Job Description, Additional Details, etc.) ... -->
        <div class="recruiter-workflow-requirement-job-title-company-name-container2">
          <div id="certification-issued-date-container" class="recruiter-workflow-requirement-issued-date-container3">
            <div id="container" class="recruiter-workflow-requirement-container27">
              <span id="certificate-issued-date" class="recruiter-workflow-requirement-issuing-date-text3">Notice Period <span style="color: red;">*</span></span>
              <div id="select-container" class="recruiter-workflow-requirement-select-container4" style="position: relative;">
                <div id="certification-issued-date-dropdown" class="recruiter-workflow-requirement-form2 input" (click)="toggleNoticePeriodDropdown()" style="cursor: pointer;">
                  <span id="select-text" class="recruiter-workflow-requirement-select-text2" [style.color]="selectedNoticePeriod ? '#000' : '#888'">{{ selectedNoticePeriod || 'Select' }}</span>
                  <svg id="issued-date-dropdown-icon" width="24" height="24" viewBox="0 0 32 32" class="recruiter-workflow-requirement-drop-down-icon2" [style.transform]="isNoticePeriodDropdownOpen ? 'rotate(180deg)' : 'rotate(0deg)'" style="transition: transform 0.3s ease;"><path d="M16 22L6 12l1.4-1.4l8.6 8.6l8.6-8.6L26 12z" fill="currentColor"></path></svg>
                </div>
                <ul *ngIf="isNoticePeriodDropdownOpen" class="custom-dropdown-list">
                  <li *ngFor="let option of noticePeriodOptions" class="custom-dropdown-item" (click)="selectNoticePeriod(option)">{{ option }}</li>
                </ul>
              </div>
              <span *ngIf="isNoticePeriodInvalid" class="error-text" style="color: red; font-size: 12px; margin-top: 4px;">
        Notice Period is required.
    </span>
            </div>
          </div>
          <div id="certification-credentials-container" class="recruiter-workflow-requirement-credentials-container">
            <span id="certification-credentials-text" class="recruiter-workflow-requirement-credentials-text"><span>Gender <span style="color: red;">*</span></span><br /></span>
            <div id="select-container" class="recruiter-workflow-requirement-select-container5" style="position: relative;">
              <div id="certification-credentials-dropdown" class="recruiter-workflow-requirement-form3 input" (click)="toggleGenderDropdown()" style="cursor: pointer;">
                <span id="select-text" class="recruiter-workflow-requirement-select-text3" [style.color]="selectedGender ? '#000' : '#888'">{{ selectedGender || 'Select' }}</span>
                <svg id="credentials-dropdown-icon" width="24" height="24" viewBox="0 0 32 32" class="recruiter-workflow-requirement-drop-down-icon3" [ngClass]="{'input-error': isGenderInvalid}" [style.transform]="isGenderDropdownOpen ? 'rotate(180deg)' : 'rotate(0deg)'" style="transition: transform 0.3s ease;"><path d="M16 22L6 12l1.4-1.4l8.6 8.6l8.6-8.6L26 12z" fill="currentColor"></path></svg>
              </div>
              <ul *ngIf="isGenderDropdownOpen" class="custom-dropdown-list">
                <li *ngFor="let option of genderOptions" class="custom-dropdown-item" (click)="selectGender(option)">{{ option }}</li>
              </ul>
            </div>
            <span *ngIf="isGenderInvalid" class="error-text" style="color: red; font-size: 12px; margin-top: 4px;">
        Gender is required.
    </span>
          </div>
          
        </div>
        <div id="skills-container" class="recruiter-workflow-requirement-skills-container">
          <div id="skill-text-container" class="recruiter-workflow-requirement-skill-text-container">
            <span id="skill-text" class="recruiter-workflow-requirement-skill-text">Job Description<span style="color: red;">*</span></span>
            <span id="skill-star-text" class="recruiter-workflow-requirement-skill-star-text"></span>
          </div>
          <textarea id="job-description-input" placeholder="Enter Job Description" class="recruiter-workflow-requirement-job-title-input3 input" [ngClass]="{'input-error': isJobDescriptionInvalid}" [(ngModel)]="jobDescription" (input)="validateJobDescription()" (blur)="validateJobDescription()" style="height: 100px; padding-top: 10px; white-space: pre-wrap; word-wrap: break-word; resize: none;"></textarea>
          <div *ngIf="isJobDescriptionInvalid" style="margin-top: 5px;"><span class="error-text">Job Description is required.</span></div>
        </div>
        <div id="interview-process-container" class="recruiter-workflow-requirement-interview-process-container">
          <span id="interview-process-text" class="recruiter-workflow-requirement-interview-process-text">Additional Details</span>
          <div id="different-stages-container" class="recruiter-workflow-requirement-different-stages-container">
            <div *ngFor="let detail of additionalDetails; let i = index" id="different-stage-container" class="recruiter-workflow-requirement-different-stage-container">
              <input type="text" [id]="'location-input-' + i" placeholder="Location" class="recruiter-workflow-requirement-date-input1 input" [(ngModel)]="detail.location" (input)="validateDetailLocation(i, $event)" />
              <input type="text" [id]="'spoc-input-' + i" placeholder="Spoc" class="recruiter-workflow-requirement-date-input2 input" [(ngModel)]="detail.spoc" (input)="validateDetailSpoc(i, $event)" />
              <input type="text" [id]="'vacancies-input-' + i" placeholder="Number of vacencies" class="recruiter-workflow-requirement-date-input3 input" [(ngModel)]="detail.vacancies" (input)="validateDetailVacancies(i, $event)" />
              <div class="email-container">
                <input type="email" placeholder="Spoc Email" class="recruiter-workflow-requirement-date-input4 input" [(ngModel)]="detail.email" (input)="validateAdditionalDetails(i)"  />
                <div style="width: 100%; display: flex; gap: 20px; font-size: 12px; color: red;">
                  <span *ngIf="additionalDetailsErrors[i]?.email">{{ additionalDetailsErrors[i].email }}</span>
                </div>
              </div>
              <div class="phone-container">
              <input type="text" placeholder="Spoc Phone" class="recruiter-workflow-requirement-date-input5 input" [(ngModel)]="detail.phone" (input)="validateAdditionalDetails(i)" maxlength="10" />
              <div style="width: 100%; display: flex; gap: 20px; font-size: 12px; color: red;">
                <span *ngIf="additionalDetailsErrors[i]?.phone">{{ additionalDetailsErrors[i].phone }}</span>
              </div>
              </div>
              <svg id="remove-icon" width="24" height="24" viewBox="0 0 24 24" class="recruiter-workflow-requirement-remove-icon" (click)="removeDetail(i)" style="cursor: pointer;"><path d="M19 13H5v-2h14z" fill="currentColor"></path></svg>
            </div>
          </div>
          <div id="add-section-container" class="recruiter-workflow-requirement-add-section-container">
            <span id="add-section-text" class="recruiter-workflow-requirement-add-section-text button" (click)="addDetail()" style="cursor: pointer;">+ Add Location</span>
            <span id="remove-section-text" class="recruiter-workflow-requirement-remove-section-text button" style="cursor: pointer;">- Remove Section</span>
          </div>
        </div>
      </div>
      <div id="submit-cancel-buttons-container" class="recruiter-workflow-requirement-submit-cancel-buttons-container">
        <button id="cancel-button" type="button" class="recruiter-workflow-requirement-cancel-button button" (click)="onCancel()">
          <span id="cancel-text" class="recruiter-workflow-requirement-cancel-text">Cancel</span>
        </button>
        <button id="submit-button" type="button" class="recruiter-workflow-requirement-submit-button button" (click)="onSubmit()">
          <span id="submit-text" class="recruiter-workflow-requirement-submit-text">Submit</span>
        </button>
      </div>
    </div>
  </div>
</ng-container>
<div class="assessment-taken-page-container10">
  <div
    id="assessment-taken-main-container"
    class="assessment-taken-page-assessment-taken-main-container"
  > 
    <navbar-for-candidate-view
    rootClassName="navbar-for-candidate-viewroot-class-name"
  >
    <ng-template >
      <div class="candidate-home-fragment10">
        <a [routerLink]="['/candidate-dashboard-main']" class="candidate-home-text100">Dashboard</a>
      </div>
    </ng-template>
    <ng-template >
      <div class="candidate-home-fragment11">
        <a [routerLink]="['/candidate-assessment']" class="candidate-home-text101">Upskill</a>
      </div>
    </ng-template>
    <ng-template >
      <div class="candidate-home-fragment12">
        <a [routerLink]="['/candidate-assessment']" class="candidate-home-text102">Assessment</a>
      </div>
    </ng-template>
    <ng-template >
      <div class="candidate-home-fragment13">
        <span [routerLink]="['/candidate-dashboard-main']" class="candidate-home-text103">Jobs for you</span>
      </div>
    </ng-template>
    <ng-template #text1>
      <div class="candidate-home-fragment14">
        <span [routerLink]="['/profile-overview-page']" class="candidate-home-text104">Profile</span>
      </div>
    </ng-template>
    <ng-template #text2>
      <div class="candidate-home-fragment15">
        <span class="candidate-home-text105">Preference</span>
      </div>
    </ng-template>
    <ng-template #text3>
      <div class="candidate-home-fragment16">
        <span class="candidate-home-text106">Settings</span>
      </div>
    </ng-template>
    <ng-template #text4>
      <div class="candidate-home-fragment17">
        <span class="candidate-home-text107">
          {{ userProfile.first_name }} {{ userProfile.last_name }}
        </span>
      </div>
    </ng-template>
    <ng-template #text5>
      <div class="candidate-home-fragment18">
        <span class="candidate-home-text108">‚úÖ 90% Profile Completion</span>
      </div>
    </ng-template>
    <ng-template #text6>
      <div class="candidate-home-fragment19">
        <span [routerLink]="['/profile-overview-page']" class="candidate-home-text109">View & edit profile</span>
      </div>
    </ng-template>
    <ng-template #text7>
      <div class="candidate-home-fragment20">
        <a [routerLink]="['/candidate-dashboard-main']" class="candidate-home-text110">Dashboard</a>
      </div>
    </ng-template>
    <ng-template #text8>
      <div class="candidate-home-fragment21">
        <span class="candidate-home-text111">Upskill</span>
      </div>
    </ng-template>
    <ng-template #text9>
      <div class="candidate-home-fragment22">
        <a [routerLink]="['/candidate-assessment']" class="candidate-home-text112">Assessment</a>
      </div>
    </ng-template>
    <ng-template #text10>
      <div class="candidate-home-fragment23">
        <span class="candidate-home-text113">Jobs for you</span>
      </div>
    </ng-template>
    <ng-template #text11>
      <div class="candidate-home-fragment24">
        <span class="candidate-home-text114">Preference</span>
      </div>
    </ng-template>
    <ng-template #text12>
      <div class="candidate-home-fragment25">
        <span class="candidate-home-text115">Settings</span>
      </div>
    </ng-template>
    <ng-template #text13>
      <div class="candidate-home-fragment26">
        <span class="candidate-home-text116">Logout</span>
      </div>
    </ng-template>
    <ng-template #text31>
      <div class="candidate-home-fragment27">
        <span class="candidate-home-text117">Logout</span>
      </div>
    </ng-template>
  </navbar-for-candidate-view>
    <div id="assessments-taken-container" class="assessment-taken-page-assessments-taken-container1">
  <div class="assessment-taken-page-container18" *ngIf="selectedAssessmentId === null">
    <span id="total-assessments-taken-text" class="assessment-taken-page-total-assessments-taken-text">
      All Assessment Taken
    </span>
    <div *ngIf="assessments?.length > 0" id="job-title-container" class="assessment-taken-page-job-title-container input">
      <input type="text" placeholder="Search assessments..." [(ngModel)]="searchQuery" class="assessment-taken-page-job-title-keyword-text" />
      <div id="search-icon-container" class="assessment-taken-page-search-icon-container">
        <svg width="24" height="24" viewBox="0 0 24 24" class="assessment-taken-page-search-icon">
          <g fill="none" fill-rule="evenodd">
            <path d="M24 0v24H0V0zM12.593 23.258l-.011.002l-.071.035l-.02.004l-.014-.004l-.071-.035q-.016-.005-.024.005l-.004.01l-.017.428l.005.02l.01.013l.104.074l.015.004l.012-.004l.104-.074l.012-.016l.004-.017l-.017-.427q-.004-.016-.017-.018m.265-.113l-.013.002l-.185.093l-.01.01l-.003.011l.018.43l.005.012l.008.007l.201.093q.019.005.029-.008l.004-.014l-.034-.614q-.005-.019-.02-.022m-.715.002a.02.02 0 0 0-.027.006l-.006.014l-.034.614q.001.018.017.024l.015-.002l.201-.093l.01-.008l.004-.011l.017-.43l-.003-.012l-.01-.01z"></path>
            <path d="M5 10a5 5 0 1 1 10 0a5 5 0 0 1-10 0m5-7a7 7 0 1 0 4.192 12.606l5.1 5.101a1 1 0 0 0 1.415-1.414l-5.1-5.1A7 7 0 0 0 10 3" fill="currentColor"></path>
          </g>
        </svg>
      </div>
    </div>
  </div>
  <div id="assessments-container" class="assessment-taken-page-assessments-container" (scroll)="onScroll($event)">
    <!-- Show the assessment list only if no assessment is selected -->
    <div *ngIf="selectedAssessmentId === null">
      <!-- Loading indicator -->
      <div *ngIf="isLoading" class="loading-container">
        <div class="loading-spinner"></div>
        <p>Loading Assessment Results...</p>
      </div>
      <!-- Show message if assessments array is empty -->
      <div *ngIf="!isLoading && assessments?.length === 0" class="no-assessments-message">
        No assessments taken yet.
      </div>
      <!-- Show assessments if array is not empty -->
      <div *ngIf="assessments?.length > 0">
        <div *ngFor="let assessment of getDisplayedAssessments()">
          <div class="assessment-taken-page-first-assessment-container">
            <div class="assessment-taken-page-assessment-details-container">
              <img [src]="assessment.assessment_logo_url || '../../../assets/assessment_logo/sap_logo1.png'" alt="image" class="assessment-taken-page-assessment-image1" />
              <div id="details" class="assessment-taken-page-details">
                <span class="assessment-taken-page-heading-text1">{{assessment.assessment_title}}</span>
                <div class="assessment-taken-page-assessment-date-id-container">
                  <span class="assessment-taken-page-details-text">
                    Completed: {{assessment.latest_end_time | date:'MM/dd/yyyy'}} | Assessment ID : {{assessment.assessment_id}}
                  </span>
                </div>
                <div class="assessment-taken-page-assessment-by-container1">
                  <img [src]="assessment.assessment_logo_url || '../../../assets/assessment_logo/sap_logo1.png'" alt="image" class="assessment-taken-page-assessment-company-logo" />
                  <span class="assessment-taken-page-assessment-by-text1">Assessment by {{assessment.created_by}}</span>
                </div>
              </div>
            </div>
            <div class="assessment-taken-page-score-board-container">
                <span class="assessment-taken-page-score-board-text">üèÜ Score Board</span>
                <div class="assessment-taken-page-score-code-container">
                  <div class="assessment-taken-page-container20">
                    <div class="assessment-taken-page-container21">
                      <div class='progress-container'>
                        <div class="progress">
                          <div class="bar" [style.width.%]="assessment.latest_score" [style.backgroundColor]="getFillColor(assessment.latest_score)"></div>
                        </div>
                        <span class="score">{{assessment.latest_score}}%</span>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            <div class="assessment-taken-page-score-container">
              
              <div class="assessment-taken-page-attempts-remaining-container">
                <span class="assessment-taken-page-attempts-remaining-text">Attempt(s) Remaining</span>
                <span>{{assessment.attempts_remaining < 0 ? 0 : assessment.attempts_remaining}}</span>
              </div>
              <svg
                id="right-icon"
                width="24"
                height="24"
                viewBox="0 0 24 24"
                class="assessment-taken-page-right-icon1"
                (click)="selectAssessment(assessment.assessment_id)"
                style="cursor: pointer;"
              >
                <path
                  d="m10 16l4-4l-4-4"
                  fill="none"
                  stroke="currentColor"
                  stroke-width="2"
                  stroke-linecap="round"
                  stroke-linejoin="round"
                ></path>
              </svg>
            </div>
          </div>
        </div>
        <div *ngIf="getFilteredAssessments().length === 0" class="no-assessments-message">
          No assessment found.
        </div>
        <!-- <span id="see-more-text1" class="assessment-taken-page-see-more-text1" *ngIf="assessments?.length > 0">See More</span> -->
      </div>
    </div>
    <!-- Show the attempts list when an assessment is selected -->
    <assessment-attempts-list 
      *ngIf="selectedAssessmentId !== null" 
      [assessmentId]="selectedAssessmentId"
      (back)="closeDetailView()">
    </assessment-attempts-list>
  </div>
</div>

<!-- Styles for pagination and loading indicators -->
<style>
.loading-spinner {
  border: 4px solid #f3f3f3;
  border-top: 4px solid #3498db;
  border-radius: 50%;
  width: 40px;
  height: 40px;
  animation: spin 1s linear infinite;
  margin: 0 auto 10px;
}

.small-spinner {
  border: 2px solid #f3f3f3;
  border-top: 2px solid #3498db;
  border-radius: 50%;
  width: 20px;
  height: 20px;
  animation: spin 1s linear infinite;
  margin: 0 auto 5px;
}

@keyframes spin {
  0% { transform: rotate(0deg); }
  100% { transform: rotate(360deg); }
}

.loading-container, .loading-more {
  text-align: center;
  padding: 40px 20px;
}

.load-more-container {
  min-height: 60px;
  display: flex;
  align-items: center;
  justify-content: center;
}
</style>




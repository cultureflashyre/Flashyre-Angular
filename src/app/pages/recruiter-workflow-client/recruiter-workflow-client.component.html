<div class="recruiter-workflow-client-container10">
  <div class="recruiter-workflow-client-container11">
    <recruiter-workflow-navbar
      rootClassName="recruiter-workflow-navbarroot-class-name4"
    >
      <ng-template #link1>
        <div class="recruiter-workflow-client-fragment10">
          <span class="recruiter-workflow-client-text10">Home</span>
        </div>
      </ng-template>
      <ng-template #link4>
        <div class="recruiter-workflow-client-fragment11">
          <span class="recruiter-workflow-client-text11">Requirments</span>
        </div>
      </ng-template>
      <ng-template #text1>
        <div class="recruiter-workflow-client-fragment12">
          <span class="recruiter-workflow-client-text12">Profile</span>
        </div>
      </ng-template>
      <ng-template #text2>
        <div class="recruiter-workflow-client-fragment13">
          <span class="recruiter-workflow-client-text13">Preference</span>
        </div>
      </ng-template>
      <ng-template #text3>
        <div class="recruiter-workflow-client-fragment14">
          <span class="recruiter-workflow-client-text14">Settings</span>
        </div>
      </ng-template>
      <ng-template #text7>
        <div class="recruiter-workflow-client-fragment15">
          <span class="recruiter-workflow-client-text15">Dashboard</span>
        </div>
      </ng-template>
      <ng-template #text9>
        <div class="recruiter-workflow-client-fragment16">
          <span class="recruiter-workflow-client-text16">Notifications</span>
        </div>
      </ng-template>
      <ng-template #text10>
        <div class="recruiter-workflow-client-fragment17">
          <span class="recruiter-workflow-client-text17">Jobs Posted</span>
        </div>
      </ng-template>
      <ng-template #text11>
        <div class="recruiter-workflow-client-fragment18">
          <span class="recruiter-workflow-client-text18">Preference</span>
        </div>
      </ng-template>
      <ng-template #text12>
        <div class="recruiter-workflow-client-fragment19">
          <span class="recruiter-workflow-client-text19">Settings</span>
        </div>
      </ng-template>
      <ng-template #text13>
        <div class="recruiter-workflow-client-fragment20">
          <span class="recruiter-workflow-client-text20">Logout</span>
        </div>
      </ng-template>
      <ng-template #text14>
        <div class="recruiter-workflow-client-fragment21">
          <span class="recruiter-workflow-client-text21">2</span>
        </div>
      </ng-template>
      <ng-template #text15>
        <div class="recruiter-workflow-client-fragment22">
          <span class="recruiter-workflow-client-text22">Leslie Alexander</span>
        </div>
      </ng-template>
      <ng-template #text16>
        <div class="recruiter-workflow-client-fragment23">
          <span class="recruiter-workflow-client-text23">Google</span>
        </div>
      </ng-template>
      <ng-template #text31>
        <div class="recruiter-workflow-client-fragment24">
          <span class="recruiter-workflow-client-text24">Logout</span>
        </div>
      </ng-template>
      <ng-template #text32>
        <div class="recruiter-workflow-client-fragment25">
          <span class="recruiter-workflow-client-text25">
            <span>Software Development</span>
            <br />
            <span>Mountain View, CA</span>
          </span>
        </div>
      </ng-template>
      <ng-template #text1411>
        <div class="recruiter-workflow-client-fragment26">
          <span class="recruiter-workflow-client-text29">2</span>
        </div>
      </ng-template>
    </recruiter-workflow-navbar>
    <div class="recruiter-workflow-client-clients-listing-container">
      <!-- Add Client Button with functionality -->
      <div
        id="cv-jd-upload-container"
        class="recruiter-workflow-client-cvjd-upload-container"
      >
        <button
          type="button" 
          (click)="openAddClientForm()"
          class="recruiter-workflow-client-add-questions-with-ai-button button"
        >
          <span class="recruiter-workflow-client-add-questions-with-ai-text">
            + Add Client
          </span>
        </button>
      </div>

      <!-- MAIN FORM START -->
      <form [formGroup]="mainForm" *ngIf="showForm">
        <div class="recruiter-workflow-client-recruiter-workflow-client-input-form">
          <div class="recruiter-workflow-client-container12">
            <span class="recruiter-workflow-client-text30">Client Input form</span>
          </div>

          <!-- CLIENTS LOOP -->
          <ng-container formArrayName="clients">
            <div *ngFor="let client of clientsArray.controls; let i = index" [formGroupName]="i" 
                 style="border-bottom: 1px solid #e0e0e0; margin-bottom: 20px; padding-bottom: 20px;">
              
              <!-- Header for Client Block if multiple -->
              <div *ngIf="clientsArray.length > 1" style="display: flex; justify-content: space-between; margin-bottom: 10px;">
                 <strong>Client #{{i + 1}}</strong>
                 <button type="button" (click)="removeClient(i)" style="color: red; border: none; background: none; cursor: pointer;">Remove Client</button>
              </div>

              <div class="recruiter-workflow-client-container13">
                
                <!-- ROW 1: Company Name (NEW) & Client Name -->
                <div class="recruiter-workflow-client-job-title-company-name-container">
                  
                  <!-- 1. Company Name (New Field) -->
                  <div
                    id="candidate-job-title"
                    class="recruiter-workflow-client-job-title-container"
                  >
                   <div
                      id="skill-text-container-1"
                      class="recruiter-workflow-client-skill-text-container-1"
                    >
                    <span class="recruiter-workflow-client-job-title-text">Company Name</span>
                    <span class="recruiter-workflow-client-skill-star-text">*</span>
                   </div>
                    <input 
                      type="text" 
                      formControlName="company_name" 
                      placeholder="Enter Company Name" 
                      class="recruiter-workflow-client-job-title-input1 input"/>
                    <!-- Validation Error -->
                    <div *ngIf="client.get('company_name')?.invalid && client.get('company_name')?.touched" style="color: red; font-size: 12px; margin-top: 4px;">
                      <span *ngIf="client.get('company_name')?.errors?.['required']">Company Name is required.</span>
                      <span *ngIf="client.get('company_name')?.errors?.['pattern']">Only alphabets and spaces allowed.</span>
                    </div>
                  </div>

                  <!-- 2. Client Name -->
                  <div
                    id="candidate-company-name-container"
                    class="recruiter-workflow-client-company-name-container"
                  >
                  <div
                      id="skill-text-container-2"
                      class="recruiter-workflow-client-skill-text-container-2"
                    >
                    <span class="recruiter-workflow-client-company-name-text">Client Name</span>
                    <span class="recruiter-workflow-client-skill-star-text">*</span>
                  </div>
                    <input 
                      type="text" 
                      formControlName="client_name" 
                      placeholder="Enter Client Name" 
                      class="recruiter-workflow-client-company-name-input input"/>
                    <!-- Validation Error -->
                    <div *ngIf="client.get('client_name')?.invalid && client.get('client_name')?.touched" style="color: red; font-size: 12px; margin-top: 4px;">
                        <span *ngIf="client.get('client_name')?.errors?.['required']">Client Name is required.</span>
                        <span *ngIf="client.get('client_name')?.errors?.['pattern']">Only alphabets and spaces allowed.</span>
                    </div>
                  </div>
                </div>

                <!-- ROW 2: Sub-Client & Description -->
                <div class="recruiter-workflow-client-job-title-company-name-container">
                  
                  <!-- 3. Sub Client Name -->
                  <div class="recruiter-workflow-client-job-title-container">
                      <span class="recruiter-workflow-client-job-title-text">Sub Client Name</span>
                      <input 
                        type="text" 
                        formControlName="sub_client_name" 
                        placeholder="Enter Sub-Client Name" 
                        class="recruiter-workflow-client-job-title-input1 input"/>
                      <div *ngIf="client.get('sub_client_name')?.invalid && client.get('sub_client_name')?.touched" style="color: red; font-size: 12px; margin-top: 4px;">
                          <span *ngIf="client.get('sub_client_name')?.errors?.['pattern']">Only alphabets and spaces allowed.</span>
                      </div>
                  </div>

                  <!-- 4. Client Description -->
                  <div
                    id="skills-container"
                    class="recruiter-workflow-client-skills-container"
                  >
                    <div
                      id="skill-text-container"
                      class="recruiter-workflow-client-skill-text-container"
                    >
                      <span class="recruiter-workflow-client-skill-text">Client Description</span>
                      <span class="recruiter-workflow-client-skill-star-text">*</span>
                    </div>
                    <input
                      type="text"
                      formControlName="client_description"
                      placeholder="Description" 
                      class="recruiter-workflow-client-job-title-input2 input"
                    />
                     <div *ngIf="client.get('client_description')?.invalid && client.get('client_description')?.touched" style="color: red; font-size: 12px; margin-top: 4px;">
                          <span *ngIf="client.get('client_description')?.errors?.['required']">Description is required.</span>
                     </div>
                  </div>
                </div>

                <!-- CONTACT INFORMATION (Nested FormArray) -->
                <div
  id="interview-process-container"
  class="recruiter-workflow-client-interview-process-container"
>
  <span
    id="interview-process-text"
    class="recruiter-workflow-client-interview-process-text"
  >
    Contact Information
  </span>
  
  <div
    id="different-stages-container"
    class="recruiter-workflow-client-different-stages-container" 
    formArrayName="contacts"
  >
    <!-- Loop through Contacts/Locations -->
    <div 
      *ngFor="let contact of getContactsArray(i).controls; let j = index" 
      [formGroupName]="j"
      id="different-stage-container"
      class="recruiter-workflow-client-different-stage-container"
    >
      <!-- Location -->
      <div>
        <input 
          type="text" 
          formControlName="location" 
          placeholder="Location" 
          class="recruiter-workflow-client-date-input1 input"
        />
        <span 
          *ngIf="contact.get('location')?.invalid && contact.get('location')?.touched" 
          style="color: red; font-size: 10px;"
        >
          Required
        </span>
      </div>

      <!-- Spoc -->
      <div>
        <input 
          type="text" 
          formControlName="spoc_name" 
          placeholder="Spoc" 
          class="recruiter-workflow-client-date-input2 input"
        />
        <span 
          *ngIf="contact.get('spoc_name')?.hasError('pattern') && contact.get('spoc_name')?.touched" 
          style="color: red; font-size: 10px;"
        >
          Alpha only
        </span>
      </div>

      <!-- Phone -->
      <div>
        <input 
          type="text" 
          formControlName="phone_number" 
          placeholder="Phone Number" 
          class="recruiter-workflow-client-date-input3 input"
        />
        <span 
          *ngIf="contact.get('phone_number')?.hasError('pattern') && contact.get('phone_number')?.touched" 
          style="color: red; font-size: 10px;"
        >
          Digits only
        </span>
      </div>

      <!-- Email -->
      <div>
        <input 
          type="text" 
          formControlName="email" 
          placeholder="Email" 
          class="recruiter-workflow-client-date-input4 input"
        />
        <span 
          *ngIf="contact.get('email')?.hasError('email') && contact.get('email')?.touched" 
          style="color: red; font-size: 10px;"
        >
          Invalid Email
        </span>
      </div>

      <!-- Remove Icon -->
      <svg 
        (click)="removeLocation(i, j)" 
        *ngIf="getContactsArray(i).length > 1"
        id="remove-icon" 
        width="24" 
        height="24" 
        viewBox="0 0 24 24" 
        class="recruiter-workflow-client-remove-icon"
        style="cursor: pointer;"
      >
        <path d="M19 13H5v-2h14z" fill="currentColor"></path>
      </svg>
    </div>
  </div>

  <div
    id="add-section-container"
    class="recruiter-workflow-client-add-section-container"
  >
    <span 
      (click)="addLocation(i)" 
      id="add-section-text"
      class="recruiter-workflow-client-add-section-text button"
      style="cursor: pointer;"
    >
      + Add Location
    </span>
    <span
      id="remove-section-text"
      class="recruiter-workflow-client-remove-section-text button"
    >
      - Remove Section
    </span>
  </div>
</div>


              </div>
            </div>
          </ng-container>
          <!-- END CLIENTS LOOP -->

          <div
           id="submit-cancel-buttons-container"
           class="recruiter-workflow-client-submit-cancel-buttons-container"
          >
            <button
              type="button" 
              (click)="closeForm()"
              class="recruiter-workflow-client-cancel-button button"
            >
              <span class="recruiter-workflow-client-cancel-text">Cancel</span>
            </button>
            <button
              type="button" 
              (click)="onSubmit()"
              class="recruiter-workflow-client-submit-button button"
            >
              <span class="recruiter-workflow-client-submit-text">Submit</span>
            </button>
          </div>
        </div>
      </form>
      <div *ngIf="isLoading" class="loader-container">
  <div class="round-loader"></div>
  <p>Saving Data...</p>
</div>
      <!-- MAIN FORM END -->

      <div class="recruiter-workflow-client-recruiter-workflow-client-list" *ngIf="showList">
        <div
          id="select-filter-sort-download-zip-main-container"
          class="recruiter-workflow-client-select-filter-sort-download-zip-main-container"
        >
          <div class="recruiter-workflow-client-container14">
            <div
              id="select-all-main-container"
              class="recruiter-workflow-client-select-all-main-container1"
            >
              <input
                type="checkbox"
                id="select-checkbox"
                class="recruiter-workflow-client-select-checkbox1"
                (change)="toggleSelectAll($event)"
              />
              <span class="recruiter-workflow-client-select-all-text">
                Select All
              </span>
            </div>
            <div class="recruiter-workflow-client-container15">
              <div
                id="select-all-main-container"
                class="recruiter-workflow-client-select-all-main-container2"
              >
                <svg
                  width="24"
                  height="24"
                  viewBox="0 0 24 24"
                  class="recruiter-workflow-client-icon11"
                >
                  <path
                    d="M14 2H4v20h16V8zm2 14h-3v3h-2v-3H8v-2h3v-3h2v3h3zm-3-7V3.5L18.5 9z"
                    fill="currentColor"
                  ></path>
                </svg>
                <div class="recruiter-workflow-client-container16">
                  <span>Add</span>
                  <svg
                    width="24"
                    height="24"
                    viewBox="0 0 24 24"
                    class="recruiter-workflow-client-icon13"
                  >
                    <path
                      d="M1.646 4.646a.5.5 0 0 1 .708 0L8 10.293l5.646-5.647a.5.5 0 0 1 .708.708l-6 6a.5.5 0 0 1-.708 0l-6-6a.5.5 0 0 1 0-.708"
                      fill="currentColor"
                      fill-rule="evenodd"
                    ></path>
                  </svg>
                </div>
              </div>
            </div>
          </div>
          <div
            id="filter-sort-download-zip-container"
            class="recruiter-workflow-client-filter-sort-download-zip-container"
          >
            <div
              id="filtered-container"
              class="recruiter-workflow-client-filtered-container"
            >
              <button
                id="filtered-button"
                type="button"
                (click)="deleteSelectedClients()"
                class="recruiter-workflow-client-filtered-button1 button"
              >
                <span class="recruiter-workflow-client-start-process-text1">
                  Delete
                </span>
              </button>
              <button
                id="filtered-button"
                type="button"
                class="recruiter-workflow-client-filtered-button2 button"
              >
                <span class="recruiter-workflow-client-start-process-text2">
                  Filtered By
                </span>
              </button>
            </div>
            <div
              data-thq="thq-dropdown"
              class="recruiter-workflow-client-sort-dropdown list-item"
            >
              <div
                data-thq="thq-dropdown-toggle"
                class="recruiter-workflow-client-dropdown-toggle1"
              >
                <span class="recruiter-workflow-client-text32">Sort</span>
                <div
                  data-thq="thq-dropdown-arrow"
                  class="recruiter-workflow-client-dropdown-arrow"
                >
                  <svg
                    viewBox="0 0 1024 1024"
                    class="recruiter-workflow-client-icon15"
                  >
                    <path d="M426 726v-428l214 214z"></path>
                  </svg>
                </div>
              </div>
              <ul
                data-thq="thq-dropdown-list"
                class="recruiter-workflow-client-dropdown-list"
              >
                <li
                  data-thq="thq-dropdown"
                  class="recruiter-workflow-client-dropdown1 list-item"
                >
                  <div
                    data-thq="thq-dropdown-toggle"
                    class="recruiter-workflow-client-dropdown-toggle2"
                  >
                    <span class="recruiter-workflow-client-text33">
                      Sub-menu Item
                    </span>
                  </div>
                </li>
                <li
                  data-thq="thq-dropdown"
                  class="recruiter-workflow-client-dropdown2 list-item"
                >
                  <div
                    data-thq="thq-dropdown-toggle"
                    class="recruiter-workflow-client-dropdown-toggle3"
                  >
                    <span class="recruiter-workflow-client-text34">
                      Sub-menu Item
                    </span>
                  </div>
                </li>
                <li
                  data-thq="thq-dropdown"
                  class="recruiter-workflow-client-dropdown3 list-item"
                >
                  <div
                    data-thq="thq-dropdown-toggle"
                    class="recruiter-workflow-client-dropdown-toggle4"
                  >
                    <span class="recruiter-workflow-client-text35">
                      Sub-menu Item
                    </span>
                  </div>
                </li>
              </ul>
            </div>
          </div>
        </div>
        <div class="recruiter-workflow-client-container17">
          <div class="recruiter-workflow-client-container18">
            
            <!-- LIST ITEM LOOP -->
            <div *ngFor="let clientData of existingClients" class="recruiter-workflow-client-container19">
              <div class="recruiter-workflow-client-container20">
                <div class="recruiter-workflow-client-container21">
                  <input type="checkbox" class="recruiter-workflow-client-select-checkbox2" [(ngModel)]="clientData.selected"/>
                </div>
                
                <div class="recruiter-workflow-client-container22">
                  <!-- Company Name -->
                  <span class="recruiter-workflow-client-text36">
                    {{ clientData.company_name }}
                  </span>
                  
                  <div class="recruiter-workflow-client-container23">
                    <div class="recruiter-workflow-client-container24">
                      <span class="recruiter-workflow-client-text37">Client</span>
                      <span class="recruiter-workflow-client-text38">{{ clientData.client_name }}</span>
                    </div>
                    <div class="recruiter-workflow-client-container25">
                      <span class="recruiter-workflow-client-text39">Sub Client</span>
                      <span class="recruiter-workflow-client-text40">{{ clientData.sub_client_name || '-' }}</span>
                    </div>
                  </div>

                  <!-- Table Header for Contacts -->
                  <div class="recruiter-workflow-client-container26">
                    <div class="recruiter-workflow-client-container27">
                      <div class="recruiter-workflow-client-container28"><h1 class="recruiter-workflow-client-text41">Location</h1></div>
                      <div class="recruiter-workflow-client-container29"><h1 class="recruiter-workflow-client-text42">Spoc</h1></div>
                      <div class="recruiter-workflow-client-container30"><h1 class="recruiter-workflow-client-text43">Phone Number</h1></div>
                      <div class="recruiter-workflow-client-container31"><h1 class="recruiter-workflow-client-text44">Email</h1></div>
                    </div>
                    
                    <!-- Contacts Loop -->
                    <div class="recruiter-workflow-client-container32">
                      <div *ngFor="let contact of clientData.contacts" class="recruiter-workflow-client-container33" style="margin-bottom: 5px;">
                        <div class="recruiter-workflow-client-container34">
                          <span class="recruiter-workflow-client-text45">{{ contact.location }}</span>
                        </div>
                        <div class="recruiter-workflow-client-container35">
                          <span class="recruiter-workflow-client-text46">{{ contact.spoc_name }}</span>
                        </div>
                        <div class="recruiter-workflow-client-container36">
                          <span class="recruiter-workflow-client-text47">{{ contact.phone_number }}</span>
                        </div>
                        <div class="recruiter-workflow-client-container37">
                          <span class="recruiter-workflow-client-text48">{{ contact.email }}</span>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>

              <!-- Action Icons (Static) -->
              <div class="recruiter-workflow-client-container38">
                <svg
                  width="24"
                  height="24"
                  viewBox="0 0 1024 1024"
                  (click)="editClientClick(clientData)"
                  class="recruiter-workflow-client-icon17"
                >
                  <path
                    d="M761.1 288.3L687.8 215L325.1 577.6l-15.6 89l88.9-15.7z"
                    fill="currentColor"
                    fill-opacity=".15"
                  ></path>
                  <path
                    d="M880 836H144c-17.7 0-32 14.3-32 32v36c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-36c0-17.7-14.3-32-32-32m-622.3-84c2 0 4-.2 6-.5L431.9 722c2-.4 3.9-1.3 5.3-2.8l423.9-423.9a9.96 9.96 0 0 0 0-14.1L694.9 114.9c-1.9-1.9-4.4-2.9-7.1-2.9s-5.2 1-7.1 2.9L256.8 538.8c-1.5 1.5-2.4 3.3-2.8 5.3l-29.5 168.2a33.5 33.5 0 0 0 9.4 29.8c6.6 6.4 14.9 9.9 23.8 9.9m67.4-174.4L687.8 215l73.3 73.3l-362.7 362.6l-88.9 15.7z"
                    fill="currentColor"
                  ></path></svg
                ><svg
                  width="24"
                  height="24"
                  viewBox="0 0 24 24"
                  (click)="downloadClientData(clientData)"
                  class="recruiter-workflow-client-icon20"
                >
                  <path
                    d="M14 2H4v20h16V8zm2 14h-3v3h-2v-3H8v-2h3v-3h2v3h3zm-3-7V3.5L18.5 9z"
                    fill="currentColor"
                  ></path></svg
                ><svg
                  width="20"
                  height="20"
                  viewBox="0 0 20 20"
                  (click)="deleteSingleClient(clientData)"
                  class="recruiter-workflow-client-icon22"
                >
                  <path
                    d="M8.5 4h3a1.5 1.5 0 0 0-3 0m-1 0a2.5 2.5 0 0 1 5 0h5a.5.5 0 0 1 0 1h-1.054l-1.194 10.344A3 3 0 0 1 12.272 18H7.728a3 3 0 0 1-2.98-2.656L3.554 5H2.5a.5.5 0 0 1 0-1zM5.741 15.23A2 2 0 0 0 7.728 17h4.544a2 2 0 0 0 1.987-1.77L15.439 5H4.561zM8.5 7.5A.5.5 0 0 1 9 8v6a.5.5 0 0 1-1 0V8a.5.5 0 0 1 .5-.5M12 8a.5.5 0 0 0-1 0v6a.5.5 0 0 0 1 0z"
                    fill="currentColor"
                  ></path>
                </svg>
              </div>
            </div>
            <!-- END LIST ITEM LOOP -->

          </div>
          <div class="recruiter-workflow-client-container39">
            <div class="recruiter-workflow-client-container40">
              <span class="recruiter-workflow-client-text49">
                Recruiter : 
              </span>
              <span class="recruiter-workflow-client-text50">{{ recruiterFirstName }}</span>
            </div>
            <div class="recruiter-workflow-client-container41">
              <span class="recruiter-workflow-client-text51">
                Created at : 
              </span>
              <span class="recruiter-workflow-client-text52">{{ existingClients[0]?.created_at | date:'mediumDate' }}</span>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
